<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sdynpy.core.sdynpy_data &mdash; SDynPy 0.5.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> SDynPy
          </a>
              <div class="version">
                0.5.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">SDynpy Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modal_tutorials.html">Modal Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">SDynPy Programming Interface</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SDynPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sdynpy.core.sdynpy_data</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sdynpy.core.sdynpy_data</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Defines the NDDataArray, which defines function data such as time histories.</span>

<span class="sd">This module also defines several subclasses of NDDataArray, which contain</span>
<span class="sd">function-type-specific capabilities.  Several Enumerations are also defined</span>
<span class="sd">that connect data fields from the universal file format to the NDDataArray</span>
<span class="sd">subclasses.</span>

<span class="sd">Copyright 2022 National Technology &amp; Engineering Solutions of Sandia,</span>
<span class="sd">LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS, the U.S.</span>
<span class="sd">Government retains certain rights in this software.</span>

<span class="sd">This program is free software: you can redistribute it and/or modify</span>
<span class="sd">it under the terms of the GNU General Public License as published by</span>
<span class="sd">the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">(at your option) any later version.</span>

<span class="sd">This program is distributed in the hope that it will be useful,</span>
<span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">GNU General Public License for more details.</span>

<span class="sd">You should have received a copy of the GNU General Public License</span>
<span class="sd">along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">sdynpy_coordinate</span>
<span class="kn">from</span> <span class="nn">.sdynpy_array</span> <span class="kn">import</span> <span class="n">SdynpyArray</span>
<span class="kn">from</span> <span class="nn">.sdynpy_coordinate</span> <span class="kn">import</span> <span class="n">outer_product</span>
<span class="kn">from</span> <span class="nn">.sdynpy_matrix</span> <span class="kn">import</span> <span class="n">Matrix</span>
<span class="kn">from</span> <span class="nn">..signal_processing.sdynpy_correlation</span> <span class="kn">import</span> <span class="n">mac</span>
<span class="kn">from</span> <span class="nn">..signal_processing.sdynpy_frf</span> <span class="kn">import</span> <span class="n">timedata2frf</span>
<span class="kn">from</span> <span class="nn">..signal_processing.sdynpy_cpsd</span> <span class="kn">import</span> <span class="p">(</span><span class="n">cpsd</span> <span class="k">as</span> <span class="n">sp_cpsd</span><span class="p">,</span>
                                             <span class="n">cpsd_coherence</span> <span class="k">as</span> <span class="n">sp_coherence</span><span class="p">,</span>
                                             <span class="n">cpsd_to_time_history</span><span class="p">,</span>
                                             <span class="n">cpsd_from_coh_phs</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">..fem.sdynpy_exodus</span> <span class="kn">import</span> <span class="n">Exodus</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eigh</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="kn">import</span> <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Rectangle</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">uic</span><span class="p">,</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QFont</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QCoreApplication</span><span class="p">,</span> <span class="n">QRect</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QToolTip</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QApplication</span><span class="p">,</span>
                             <span class="n">QGroupBox</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span>
                             <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span>
                             <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QErrorMessage</span><span class="p">,</span> <span class="n">QListWidget</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span>
                             <span class="n">QDockWidget</span><span class="p">,</span> <span class="n">QGridLayout</span><span class="p">,</span> <span class="n">QButtonGroup</span><span class="p">,</span> <span class="n">QDialog</span><span class="p">,</span>
                             <span class="n">QCheckBox</span><span class="p">,</span> <span class="n">QRadioButton</span><span class="p">,</span> <span class="n">QMenuBar</span><span class="p">,</span> <span class="n">QMenu</span><span class="p">,</span> <span class="n">QAction</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pyqtgraph</span>
<span class="n">pyqtgraph</span><span class="o">.</span><span class="n">setConfigOption</span><span class="p">(</span><span class="s1">&#39;background&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">pyqtgraph</span><span class="o">.</span><span class="n">setConfigOption</span><span class="p">(</span><span class="s1">&#39;foreground&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">sig</span>


<div class="viewcode-block" id="SpecificDataType"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.SpecificDataType.html#sdynpy.core.sdynpy_data.SpecificDataType">[docs]</a><span class="k">class</span> <span class="nc">SpecificDataType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enumeration containing the types of data in universal files&quot;&quot;&quot;</span>
    <span class="n">UNKNOWN</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">GENERAL</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">STRESS</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">STRAIN</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">TEMPERATURE</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">HEAT_FLUX</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">DISPLACEMENT</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">REACTION_FORCE</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">VELOCITY</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">ACCELERATION</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">EXCITATION_FORCE</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">PRESSURE</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">MASS</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">TIME</span> <span class="o">=</span> <span class="mi">17</span>
    <span class="n">FREQUENCY</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">RPM</span> <span class="o">=</span> <span class="mi">19</span>
    <span class="n">ORDER</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">SOUND_PRESSURE</span> <span class="o">=</span> <span class="mi">21</span>
    <span class="n">SOUND_INTENSITY</span> <span class="o">=</span> <span class="mi">22</span>
    <span class="n">SOUND_POWER</span> <span class="o">=</span> <span class="mi">23</span></div>


<span class="n">_specific_data_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">val</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">SpecificDataType</span><span class="p">}</span>

<span class="n">_specific_data_names_vectorized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">_specific_data_names</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)</span>

<span class="c1">#                 Table - Unit Exponents</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="c1">#  Specific                   Direction</span>
<span class="c1">#           ---------------------------------------------</span>
<span class="c1">#    Data       Translational            Rotational</span>
<span class="c1">#           ---------------------------------------------</span>
<span class="c1">#    Type    Length  Force  Temp    Length  Force  Temp</span>
<span class="c1"># -------------------------------------------------------</span>
<span class="c1">#     0        0       0      0       0       0      0</span>
<span class="c1">#     1             (requires input to fields 2,3,4)</span>
<span class="c1">#     2       -2       1      0      -1       1      0</span>
<span class="c1">#     3        0       0      0       0       0      0</span>
<span class="c1">#     5        0       0      1       0       0      1</span>
<span class="c1">#     6        1       1      0       1       1      0</span>
<span class="c1">#     8        1       0      0       0       0      0</span>
<span class="c1">#     9        0       1      0       1       1      0</span>
<span class="c1">#    11        1       0      0       0       0      0</span>
<span class="c1">#    12        1       0      0       0       0      0</span>
<span class="c1">#    13        0       1      0       1       1      0</span>
<span class="c1">#    15       -2       1      0      -1       1      0</span>
<span class="c1">#    16       -1       1      0       1       1      0</span>
<span class="c1">#    17        0       0      0       0       0      0</span>
<span class="c1">#    18        0       0      0       0       0      0</span>
<span class="c1">#    19        0       0      0       0       0      0</span>
<span class="c1"># --------------------------------------------------------</span>

<span class="n">_exponent_table</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">GENERAL</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">STRESS</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">STRAIN</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">TEMPERATURE</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">HEAT_FLUX</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">DISPLACEMENT</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">REACTION_FORCE</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">VELOCITY</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">ACCELERATION</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">EXCITATION_FORCE</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">PRESSURE</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">MASS</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">TIME</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">FREQUENCY</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">SpecificDataType</span><span class="o">.</span><span class="n">RPM</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">_exponent_table_vectorized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">_exponent_table</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)</span>


<div class="viewcode-block" id="TypeQual"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TypeQual.html#sdynpy.core.sdynpy_data.TypeQual">[docs]</a><span class="k">class</span> <span class="nc">TypeQual</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enumeration containing the quantity type (Rotation or Translation)&quot;&quot;&quot;</span>
    <span class="n">TRANSLATION</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">ROTATION</span> <span class="o">=</span> <span class="mi">1</span></div>


<span class="n">_type_qual_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">val</span><span class="p">:</span> <span class="n">val</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">TypeQual</span><span class="p">}</span>
<span class="n">_type_qual_names_vectorized</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">_type_qual_names</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)</span>


<div class="viewcode-block" id="FunctionTypes"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.FunctionTypes.html#sdynpy.core.sdynpy_data.FunctionTypes">[docs]</a><span class="k">class</span> <span class="nc">FunctionTypes</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enumeration containing types of functions found in universal files&quot;&quot;&quot;</span>
    <span class="n">GENERAL</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">TIME_RESPONSE</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">AUTOSPECTRUM</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">CROSSSPECTRUM</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">FREQUENCY_RESPONSE_FUNCTION</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">TRANSMISIBILITY</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">COHERENCE</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">AUTOCORRELATION</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">CROSSCORRELATION</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">POWER_SPECTRAL_DENSITY</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">ENERGY_SPECTRAL_DENSITY</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">PROBABILITY_DENSITY_FUNCTION</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">SPECTRUM</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">CUMULATIVE_FREQUENCY_DISTRIBUTION</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">PEAKS_VALLEY</span> <span class="o">=</span> <span class="mi">14</span>
    <span class="n">STRESS_PER_CYCLE</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">STRAIN_PER_CYCLE</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">ORBIT</span> <span class="o">=</span> <span class="mi">17</span>
    <span class="n">MODE_INDICATOR_FUNCTION</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">FORCE_PATTERN</span> <span class="o">=</span> <span class="mi">19</span>
    <span class="n">PARTIAL_POWER</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">PARTIAL_COHERENCE</span> <span class="o">=</span> <span class="mi">21</span>
    <span class="n">EIGENVALUE</span> <span class="o">=</span> <span class="mi">22</span>
    <span class="n">EIGENVECTOR</span> <span class="o">=</span> <span class="mi">23</span>
    <span class="n">SHOCK_RESPONSE_SPECTRUM</span> <span class="o">=</span> <span class="mi">24</span>
    <span class="n">FINITE_IMPULSE_RESPONSE_FILTER</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">MULTIPLE_COHERENCE</span> <span class="o">=</span> <span class="mi">26</span>
    <span class="n">ORDER_FUNCTION</span> <span class="o">=</span> <span class="mi">27</span>
    <span class="n">PHASE_COMPENSATION</span> <span class="o">=</span> <span class="mi">28</span></div>


<span class="n">_imat_function_type_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;General&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">GENERAL</span><span class="p">,</span>
                           <span class="s1">&#39;Time Response&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TIME_RESPONSE</span><span class="p">,</span>
                           <span class="s1">&#39;Auto Spectrum&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">AUTOSPECTRUM</span><span class="p">,</span>
                           <span class="s1">&#39;Cross Spectrum&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">CROSSSPECTRUM</span><span class="p">,</span>
                           <span class="s1">&#39;Frequency Response Function&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">FREQUENCY_RESPONSE_FUNCTION</span><span class="p">,</span>
                           <span class="s1">&#39;Transmissibility&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TRANSMISIBILITY</span><span class="p">,</span>
                           <span class="s1">&#39;Coherence&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">COHERENCE</span><span class="p">,</span>
                           <span class="s1">&#39;Auto Correlation&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">AUTOCORRELATION</span><span class="p">,</span>
                           <span class="s1">&#39;Cross Correlation&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">CROSSCORRELATION</span><span class="p">,</span>
                           <span class="s1">&#39;Power Spectral Density&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span><span class="p">,</span>
                           <span class="s1">&#39;Energy Spectral Density&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">ENERGY_SPECTRAL_DENSITY</span><span class="p">,</span>
                           <span class="s1">&#39;Probability Density Function&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">PROBABILITY_DENSITY_FUNCTION</span><span class="p">,</span>
                           <span class="s1">&#39;Spectrum&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span>
                           <span class="s1">&#39;Cumulative Frequency Distribution&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">CUMULATIVE_FREQUENCY_DISTRIBUTION</span><span class="p">,</span>
                           <span class="s1">&#39;Peaks Valley&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">PEAKS_VALLEY</span><span class="p">,</span>
                           <span class="s1">&#39;Stress/Cycles&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">STRESS_PER_CYCLE</span><span class="p">,</span>
                           <span class="s1">&#39;Strain/Cycles&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">STRAIN_PER_CYCLE</span><span class="p">,</span>
                           <span class="s1">&#39;Orbit&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">ORBIT</span><span class="p">,</span>
                           <span class="s1">&#39;Mode Indicator Function&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MODE_INDICATOR_FUNCTION</span><span class="p">,</span>
                           <span class="s1">&#39;Force Pattern&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">FORCE_PATTERN</span><span class="p">,</span>
                           <span class="s1">&#39;Partial Power&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">PARTIAL_POWER</span><span class="p">,</span>
                           <span class="s1">&#39;Partial Coherence&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">PARTIAL_COHERENCE</span><span class="p">,</span>
                           <span class="s1">&#39;Eigenvalue&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">EIGENVALUE</span><span class="p">,</span>
                           <span class="s1">&#39;Eigenvector&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">EIGENVECTOR</span><span class="p">,</span>
                           <span class="s1">&#39;Shock Response Spectrum&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">SHOCK_RESPONSE_SPECTRUM</span><span class="p">,</span>
                           <span class="s1">&#39;Finite Impulse Response Filter&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">FINITE_IMPULSE_RESPONSE_FILTER</span><span class="p">,</span>
                           <span class="s1">&#39;Multiple Coherence&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MULTIPLE_COHERENCE</span><span class="p">,</span>
                           <span class="s1">&#39;Order Function&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">ORDER_FUNCTION</span><span class="p">,</span>
                           <span class="s1">&#39;Phase Compensation&#39;</span><span class="p">:</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">PHASE_COMPENSATION</span><span class="p">,</span>
                           <span class="p">}</span>

<span class="n">_imat_function_type_inverse_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">val</span><span class="p">:</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">_imat_function_type_map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>


<div class="viewcode-block" id="NDDataArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray">[docs]</a><span class="k">class</span> <span class="nc">NDDataArray</span><span class="p">(</span><span class="n">SdynpyArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generic N-Dimensional data structure</span>

<span class="sd">    This data structure can contain real or complex data.  More specific</span>
<span class="sd">    SDynPy data arrays inherit from this superclass.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">data_dimension</span><span class="p">,</span> <span class="n">ordinate_dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span>
                <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Create the ndarray instance of our type, given the usual</span>
        <span class="c1"># ndarray input arguments.  This will call the standard</span>
        <span class="c1"># ndarray constructor, but return an object of our type.</span>
        <span class="c1"># It also triggers a call to __array_finalize__</span>
        <span class="n">data_dtype</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;abscissa&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">nelements</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;ordinate&#39;</span><span class="p">,</span> <span class="n">ordinate_dtype</span><span class="p">,</span> <span class="n">nelements</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;comment1&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;U80&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;comment2&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;U80&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;comment3&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;U80&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;comment4&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;U80&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;comment5&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;U80&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;coordinate&#39;</span><span class="p">,</span> <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">CoordinateArray</span><span class="o">.</span><span class="n">data_dtype</span><span class="p">,</span>
             <span class="p">()</span> <span class="k">if</span> <span class="n">data_dimension</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="n">data_dimension</span><span class="p">,))</span>
        <span class="p">]</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">,</span> <span class="n">subtype</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span>
                                                  <span class="n">data_dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="c1"># Finally, we must return the newly created object:</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array as a FunctionTypes Enum</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">GENERAL</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">response_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;CoordinateArray corresponding to the response coordinates&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="nd">@response_coordinate</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">response_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the response coordinate of the data array&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">reference_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;CoordinateArray corresponding to the response coordinates&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;coordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:}</span><span class="s1"> has no reference coordinate&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="nd">@reference_coordinate</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">reference_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the reference coordinate of the data array&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;coordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:}</span><span class="s1"> has no reference coordinate&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of elements in each data array&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;ordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of coordinates defining the data array&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;coordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Number of dimensions to the data&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;coordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<div class="viewcode-block" id="NDDataArray.plot"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">one_axis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">subplots_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
             <span class="n">plot_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the data array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        one_axis : bool, optional</span>
<span class="sd">            Set to True to plot all data on one axis.  Set to False to plot</span>
<span class="sd">            data on multiple subplots.  one_axis can also be set to a </span>
<span class="sd">            matplotlib axis to plot data on an existing axis.  The default is</span>
<span class="sd">            True.</span>
<span class="sd">        subplots_kwargs : dict, optional</span>
<span class="sd">            Keywords passed to the matplotlib subplots function to create the</span>
<span class="sd">            figure and axes. The default is {}.</span>
<span class="sd">        plot_kwargs : dict, optional</span>
<span class="sd">            Keywords passed to the matplotlib plot function. The default is {}.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        axis : matplotlib axis or array of axes</span>
<span class="sd">             On which the data were plotted</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">one_axis</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="o">**</span><span class="n">subplots_kwargs</span><span class="p">)</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">one_axis</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="o">**</span><span class="n">subplots_kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">function</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">())):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">function</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">()]))</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axis</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">one_axis</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axis</span></div>

<div class="viewcode-block" id="NDDataArray.reshape_to_matrix"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.reshape_to_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">reshape_to_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reshapes a data array to a matrix with response coordinates along the</span>
<span class="sd">        rows and reference coordinates along the columns</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output_array : Data Aarray</span>
<span class="sd">            2D Array of NDDataArray</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flattened_functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">response_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_coordinate</span><span class="p">)</span>
        <span class="n">reference_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_coordinate</span><span class="p">)</span>
        <span class="n">output_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="p">(</span><span class="n">response_coords</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">reference_coords</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">response_coord</span> <span class="ow">in</span> <span class="n">response_coords</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">col_index</span><span class="p">,</span> <span class="n">reference_coord</span> <span class="ow">in</span> <span class="n">reference_coords</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">():</span>
                <span class="n">current_function</span> <span class="o">=</span> <span class="n">flattened_functions</span><span class="p">[</span>
                    <span class="p">(</span><span class="n">flattened_functions</span><span class="o">.</span><span class="n">response_coordinate</span> <span class="o">==</span> <span class="n">response_coord</span><span class="p">)</span>
                    <span class="o">&amp;</span>
                    <span class="p">(</span><span class="n">flattened_functions</span><span class="o">.</span><span class="n">reference_coordinate</span> <span class="o">==</span> <span class="n">reference_coord</span><span class="p">)]</span>
                <span class="k">if</span> <span class="n">current_function</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No function exists with reference coordinate </span><span class="si">{:}</span><span class="s1"> and response coordinate </span><span class="si">{:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">reference_coord</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">response_coord</span><span class="p">)))</span>
                <span class="k">if</span> <span class="n">current_function</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Multiple functions exist (</span><span class="si">{:}</span><span class="s1">) with reference coordinate </span><span class="si">{:}</span><span class="s1"> and response coordinate </span><span class="si">{:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">current_function</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reference_coord</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">response_coord</span><span class="p">)))</span>
                <span class="n">output_array</span><span class="p">[</span><span class="n">row_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">current_function</span>
        <span class="k">return</span> <span class="n">output_array</span></div>

<div class="viewcode-block" id="NDDataArray.extract_elements"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.extract_elements">[docs]</a>    <span class="k">def</span> <span class="nf">extract_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses elements from the data array specified by the passed indices</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        indices : </span>
<span class="sd">            Any type of indices into a np.ndarray to select the elements to keep</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDDataArray</span>
<span class="sd">            Array reduced to specified elements</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_ordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">]</span>
        <span class="n">new_abscissa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_type</span><span class="p">,</span> <span class="n">new_abscissa</span><span class="p">,</span> <span class="n">new_ordinate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">comment1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment5</span><span class="p">)</span></div>

<div class="viewcode-block" id="NDDataArray.extract_elements_by_abscissa"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.extract_elements_by_abscissa">[docs]</a>    <span class="k">def</span> <span class="nf">extract_elements_by_abscissa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_abscissa</span><span class="p">,</span> <span class="n">max_abscissa</span><span class="p">):</span>
        <span class="n">abscissa_indices</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">&gt;=</span> <span class="n">min_abscissa</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">&lt;=</span> <span class="n">max_abscissa</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">abscissa_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">abscissa_indices</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">new_ordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">]</span>
        <span class="n">new_abscissa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_type</span><span class="p">,</span> <span class="n">new_abscissa</span><span class="p">,</span> <span class="n">new_ordinate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">comment1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment5</span><span class="p">)</span></div>

<div class="viewcode-block" id="NDDataArray.downsample"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.downsample">[docs]</a>    <span class="k">def</span> <span class="nf">downsample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Downsample a signal by keeping only every n-th abscissa/ordinate pair.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        factor : int</span>
<span class="sd">            Downsample factor.  Only the factor-th abcissa will be kept.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDDataArray</span>
<span class="sd">            The downsampled data object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_ordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">::</span><span class="n">factor</span><span class="p">]</span>
        <span class="n">new_abscissa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">::</span><span class="n">factor</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_type</span><span class="p">,</span> <span class="n">new_abscissa</span><span class="p">,</span> <span class="n">new_ordinate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">comment1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment5</span><span class="p">)</span></div>

<div class="viewcode-block" id="NDDataArray.validate_common_abscissa"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.validate_common_abscissa">[docs]</a>    <span class="k">def</span> <span class="nf">validate_common_abscissa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">allclose_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if all functions have the same abscissa</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **allclose_kwargs : various</span>
<span class="sd">            Arguments to np.allclose to specify tolerances</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if all functions have the same abscissa</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="o">**</span><span class="n">allclose_kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="NDDataArray.transform_coordinate_system"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.transform_coordinate_system">[docs]</a>    <span class="k">def</span> <span class="nf">transform_coordinate_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original_geometry</span><span class="p">,</span> <span class="n">new_geometry</span><span class="p">,</span> <span class="n">node_id_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rotations</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs coordinate system transformations on the data</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        original_geometry : Geometry</span>
<span class="sd">            The Geometry in which the shapes are currently defined</span>
<span class="sd">        new_geometry : Geometry</span>
<span class="sd">            The Geometry in which the shapes are desired to be defined</span>
<span class="sd">        node_id_map : id_map, optional</span>
<span class="sd">            If the original and new geometries do not have common</span>
<span class="sd">            node ids, an id_map can be specified to map the original geometry</span>
<span class="sd">            node ids to new geometry node ids.  The default is None, which means no</span>
<span class="sd">            mapping will occur, and the geometries have common id numbers.</span>
<span class="sd">        rotations : bool, optional</span>
<span class="sd">            If True, also transform rotational degrees of freedom. The default</span>
<span class="sd">            is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDDataArray or Subclass</span>
<span class="sd">            A NDDataArray that can now be plotted with the new geometry</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dimension</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">node_id_map</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">original_geometry</span> <span class="o">=</span> <span class="n">original_geometry</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">node_id_map</span><span class="o">.</span><span class="n">from_ids</span><span class="p">)</span>
                <span class="n">original_geometry</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">node_id_map</span><span class="p">(</span><span class="n">original_geometry</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()[</span><span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">node</span><span class="p">,</span> <span class="n">node_id_map</span><span class="o">.</span><span class="n">from_ids</span><span class="p">)]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node_id_map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">node</span><span class="p">)</span>
            <span class="n">common_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">intersect1d</span><span class="p">(</span><span class="n">original_geometry</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">new_geometry</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
                                          <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">node</span><span class="p">))</span>
            <span class="n">original_coordinate_systems</span> <span class="o">=</span> <span class="n">original_geometry</span><span class="o">.</span><span class="n">coordinate_system</span><span class="p">(</span>
                <span class="n">original_geometry</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">common_nodes</span><span class="p">)</span><span class="o">.</span><span class="n">disp_cs</span><span class="p">)</span>
            <span class="n">new_coordinate_systems</span> <span class="o">=</span> <span class="n">new_geometry</span><span class="o">.</span><span class="n">coordinate_system</span><span class="p">(</span>
                <span class="n">new_geometry</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">common_nodes</span><span class="p">)</span><span class="o">.</span><span class="n">disp_cs</span><span class="p">)</span>
            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span>
                <span class="n">common_nodes</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="k">if</span> <span class="n">rotations</span> <span class="k">else</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
            <span class="n">new_data_array</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">coordinates</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">shape_matrix</span> <span class="o">=</span> <span class="n">new_data_array</span><span class="o">.</span><span class="n">ordinate</span>
            <span class="n">transform_from_original</span> <span class="o">=</span> <span class="n">original_coordinate_systems</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">transform_to_new</span> <span class="o">=</span> <span class="n">new_coordinate_systems</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">rotations</span><span class="p">:</span>
                <span class="c1"># If we are doing rotations, we need to do a block diagonal for translations and rotations</span>
                <span class="n">transform_from_original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">transform_from_original</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                        <span class="n">transform_from_original</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">transform_from_original</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span>
                                   <span class="n">transform_from_original</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                <span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">transform_to_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">transform_to_new</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">transform_to_new</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">transform_to_new</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">transform_to_new</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                <span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">new_shape_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;nij,nkj,nkl-&gt;nil&#39;</span><span class="p">,</span> <span class="n">transform_to_new</span><span class="p">,</span>
                                         <span class="n">transform_from_original</span><span class="p">,</span> <span class="n">shape_matrix</span><span class="p">)</span>
            <span class="n">new_data_array</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">new_shape_matrix</span>
            <span class="k">return</span> <span class="n">new_data_array</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;2D Data not Implemented Yet&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects specific data items by index or by coordinate</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : CoordinateArray or indices</span>
<span class="sd">            If key is a CoordinateArray, the returned NDDataArray will have the</span>
<span class="sd">            specified coordinates.  Otherwise, any form of indices can be passed</span>
<span class="sd">            to select specific data arrays.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDDataArray</span>
<span class="sd">            Data Array partitioned to the selected arrays.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">CoordinateArray</span><span class="p">):</span>
            <span class="n">coordinate_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;coordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span>
            <span class="n">output_shape</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="n">coordinate_dim</span><span class="p">]</span>
            <span class="n">flat_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">index_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">output_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">positive_coordinates</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">flat_self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">output_shape</span><span class="p">):</span>
                <span class="n">positive_key</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                <span class="n">index_array</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">positive_coordinates</span> <span class="o">==</span> <span class="n">positive_key</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">return_shape</span> <span class="o">=</span> <span class="n">flat_self</span><span class="p">[</span><span class="n">index_array</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">COHERENCE</span><span class="p">,</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MULTIPLE_COHERENCE</span><span class="p">]:</span>
                <span class="n">ordinate_multiplication_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ordinate_multiplication_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">return_shape</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">direction</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">return_shape</span><span class="o">.</span><span class="n">coordinate</span> <span class="o">=</span> <span class="n">key</span>
            <span class="n">return_shape</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">*=</span> <span class="n">ordinate_multiplication_array</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">return_shape</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;coordinate&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">CoordinateArray</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{:}</span><span class="s1"> with shape </span><span class="si">{:}</span><span class="s1"> and </span><span class="si">{:}</span><span class="s1"> elements per function&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="s1">&#39; x &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">+=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">-=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">-=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">*=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">*=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">/=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">/=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">**=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">**=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">+=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">-</span> <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">val</span> <span class="o">-</span> <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">*=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">*=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">/</span> <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">val</span> <span class="o">/</span> <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">NDDataArray</span><span class="p">):</span>
            <span class="c1"># Check if abscissa are equivalent</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">==</span> <span class="n">val</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Binary operations on NDDataArrays require equivalent or broadcastably equivalent abscissa&#39;</span><span class="p">)</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">ordinate</span><span class="o">**</span><span class="n">this</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">val</span><span class="o">**</span><span class="n">this</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">this</span>

    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">this</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">this</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">ordinate</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">this</span>

<div class="viewcode-block" id="NDDataArray.min"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.min">[docs]</a>    <span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">min_args</span><span class="p">,</span> <span class="o">**</span><span class="n">min_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the minimum ordinate in the data array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        reduction : function, optional</span>
<span class="sd">            Optional function to modify the data, e.g. to select minimum of the</span>
<span class="sd">            absolute value. The default is None.</span>
<span class="sd">        *min_args : various</span>
<span class="sd">            Additional arguments passed to np.min</span>
<span class="sd">        **min_kwargs : various</span>
<span class="sd">            Additional keyword arguments passed to np.min</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Value</span>
<span class="sd">            Minimum value in the ordinate.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">reduction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">reduction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">))</span></div>

<div class="viewcode-block" id="NDDataArray.max"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.max">[docs]</a>    <span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">max_args</span><span class="p">,</span> <span class="o">**</span><span class="n">max_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the maximum ordinate in the data array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        reduction : function, optional</span>
<span class="sd">            Optional function to modify the data, e.g. to select maximum of the</span>
<span class="sd">            absolute value. The default is None.</span>
<span class="sd">        *max_args : various</span>
<span class="sd">            Additional arguments passed to np.max</span>
<span class="sd">        **max_kwargs : various</span>
<span class="sd">            Additional keyword arguments passed to np.max</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Value</span>
<span class="sd">            Maximum value in the ordinate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">reduction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">*</span><span class="n">max_args</span><span class="p">,</span> <span class="o">**</span><span class="n">max_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">reduction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">),</span> <span class="o">*</span><span class="n">max_args</span><span class="p">,</span> <span class="o">**</span><span class="n">max_kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="NDDataArray.argmin"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.argmin">[docs]</a>    <span class="k">def</span> <span class="nf">argmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">argmin_args</span><span class="p">,</span> <span class="o">**</span><span class="n">argmin_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the index of the minimum ordinate in the data array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        reduction : function, optional</span>
<span class="sd">            Optional function to modify the data, e.g. to select minimum of the</span>
<span class="sd">            absolute value. The default is None.</span>
<span class="sd">        *argmin_args : various</span>
<span class="sd">            Additional arguments passed to np.argmax</span>
<span class="sd">        **argmin_kwargs : various</span>
<span class="sd">            Additional keyword arguments passed to np.argmax</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Index of the minimum of the flattened ordinate.  Use</span>
<span class="sd">            np.unravel_index with self.ordinate.shape to get the unflattened</span>
<span class="sd">            index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">reduction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">*</span><span class="n">argmin_args</span><span class="p">,</span> <span class="o">**</span><span class="n">argmin_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">reduction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">),</span> <span class="o">*</span><span class="n">argmin_args</span><span class="p">,</span> <span class="o">**</span><span class="n">argmin_kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="NDDataArray.argmax"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.argmax">[docs]</a>    <span class="k">def</span> <span class="nf">argmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">argmax_args</span><span class="p">,</span> <span class="o">**</span><span class="n">argmax_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the index of the maximum ordinate in the data array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        reduction : function, optional</span>
<span class="sd">            Optional function to modify the data, e.g. to select maximum of the</span>
<span class="sd">            absolute value. The default is None.</span>
<span class="sd">        *argmax_args : various</span>
<span class="sd">            Additional arguments passed to np.argmax</span>
<span class="sd">        **argmax_kwargs : various</span>
<span class="sd">            Additional keyword arguments passed to np.argmax</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            Index of the maximum of the flattened ordinate.  Use</span>
<span class="sd">            np.unravel_index with self.ordinate.shape to get the unflattened</span>
<span class="sd">            index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">reduction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">*</span><span class="n">argmax_args</span><span class="p">,</span> <span class="o">**</span><span class="n">argmax_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">reduction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">),</span> <span class="o">*</span><span class="n">argmax_args</span><span class="p">,</span> <span class="o">**</span><span class="n">argmax_kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="NDDataArray.to_imat_struct_array"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.to_imat_struct_array">[docs]</a>    <span class="k">def</span> <span class="nf">to_imat_struct_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Version</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">SetRecord</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">CreateDate</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ModifyDate</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">OwnerName</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">AbscissaDataType</span><span class="o">=</span><span class="n">SpecificDataType</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">,</span> <span class="n">AbscissaTypeQual</span><span class="o">=</span><span class="n">TypeQual</span><span class="o">.</span><span class="n">TRANSLATION</span><span class="p">,</span>
                             <span class="n">AbscissaAxisLab</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">AbscissaUnitsLab</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                             <span class="n">OrdNumDataType</span><span class="o">=</span><span class="n">SpecificDataType</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">,</span> <span class="n">OrdNumTypeQual</span><span class="o">=</span><span class="n">TypeQual</span><span class="o">.</span><span class="n">TRANSLATION</span><span class="p">,</span>
                             <span class="n">OrdDenDataType</span><span class="o">=</span><span class="n">SpecificDataType</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">,</span> <span class="n">OrdDenTypeQual</span><span class="o">=</span><span class="n">TypeQual</span><span class="o">.</span><span class="n">TRANSLATION</span><span class="p">,</span>
                             <span class="n">OrdinateAxisLab</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">OrdinateUnitsLab</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                             <span class="n">ZAxisDataType</span><span class="o">=</span><span class="n">SpecificDataType</span><span class="o">.</span><span class="n">UNKNOWN</span><span class="p">,</span> <span class="n">ZAxisTypeQual</span><span class="o">=</span><span class="n">TypeQual</span><span class="o">.</span><span class="n">TRANSLATION</span><span class="p">,</span>
                             <span class="n">ZGeneralValue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ZRPMValue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ZOrderValue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ZTimeValue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">UserValue1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">UserValue2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">UserValue3</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">UserValue4</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">SamplingType</span><span class="o">=</span><span class="s1">&#39;Dynamic&#39;</span><span class="p">,</span> <span class="n">WeightingType</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">WindowType</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
                             <span class="n">AmplitudeUnits</span><span class="o">=</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span> <span class="n">Normalization</span><span class="o">=</span><span class="s1">&#39;Unknown&#39;</span><span class="p">,</span> <span class="n">OctaveFormat</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">OctaveAvgType</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">ExpDampingFact</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">PulsesPerRev</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">MeasurementRun</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">LoadCase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">IRIGTime</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
                             <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Matlab structure that can be read the IMAT toolbox.</span>

<span class="sd">        This structure can be read by the IMAT toolbox in Matlab to create an</span>
<span class="sd">        imat_fn object.  Note this is generally a slower function than</span>
<span class="sd">        to_imat_struct.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Version : int, optional</span>
<span class="sd">            The version number of the function. The default is 1.</span>
<span class="sd">        SetRecord : int, optional</span>
<span class="sd">            The set record of the function. The default is 0.</span>
<span class="sd">        CreateDate : datetime, optional</span>
<span class="sd">            The date that the function was created. The default is Now.</span>
<span class="sd">        ModifyDate : datetime, optional</span>
<span class="sd">            The date that the function was modified. The default is Now.</span>
<span class="sd">        OwnerName : str, optional</span>
<span class="sd">            The owner of the dataset. The default is &#39;&#39;.</span>
<span class="sd">        AbscissaDataType : SpecificDataType, optional</span>
<span class="sd">            The type of data associated with the Abscissa of the function.</span>
<span class="sd">            The default is SpecificDataType.UNKNOWN.</span>
<span class="sd">        AbscissaTypeQual : TypeQual, optional</span>
<span class="sd">            The qualifier associated with the abscissa of the function. The</span>
<span class="sd">            default is TypeQual.TRANSLATION.</span>
<span class="sd">        AbscissaAxisLab : str, optional</span>
<span class="sd">            String used to label the abscissa axis. The default is &#39;&#39;.</span>
<span class="sd">        AbscissaUnitsLab : str, optional</span>
<span class="sd">            String used to label the units on the abscissa axis. The default is &#39;&#39;.</span>
<span class="sd">        OrdNumDataType : SpecificDataType, optional</span>
<span class="sd">            The type of data associated with the numerator of the ordinate of</span>
<span class="sd">            the function. The default is SpecificDataType.UNKNOWN.</span>
<span class="sd">        OrdNumTypeQual : TypeQual, optional</span>
<span class="sd">            The qualifier associated with the numerator of the ordinate of the</span>
<span class="sd">            function. The default is TypeQual.TRANSLATION.</span>
<span class="sd">        OrdDenDataType : SpecificDataType, optional</span>
<span class="sd">            The type of data associated with the denominator of the ordinate of</span>
<span class="sd">            the function. The default is SpecificDataType.UNKNOWN.</span>
<span class="sd">        OrdDenTypeQual : TypeQual, optional</span>
<span class="sd">            The qualifier associated with the denominator of the ordinate of the</span>
<span class="sd">            function. The default is TypeQual.TRANSLATION.</span>
<span class="sd">        OrdinateAxisLab : str, optional</span>
<span class="sd">            String used to label the ordinate axis. The default is &#39;&#39;.</span>
<span class="sd">        OrdinateUnitsLab : TYPE, optional</span>
<span class="sd">            String used to label the units on the ordinate axis. The default is &#39;&#39;.</span>
<span class="sd">        ZAxisDataType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is SpecificDataType.UNKNOWN.</span>
<span class="sd">        ZAxisTypeQual : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is TypeQual.TRANSLATION.</span>
<span class="sd">        ZGeneralValue : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        ZRPMValue : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        ZOrderValue : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        ZTimeValue : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        UserValue1 : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        UserValue2 : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        UserValue3 : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        UserValue4 : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        SamplingType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is &#39;Dynamic&#39;.</span>
<span class="sd">        WeightingType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is &#39;None&#39;.</span>
<span class="sd">        WindowType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is &#39;None&#39;.</span>
<span class="sd">        AmplitudeUnits : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is &#39;Unknown&#39;.</span>
<span class="sd">        Normalization : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is &#39;Unknown&#39;.</span>
<span class="sd">        OctaveFormat : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        OctaveAvgType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is &#39;None&#39;.</span>
<span class="sd">        ExpDampingFact : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        PulsesPerRev : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        MeasurementRun : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        LoadCase : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is 0.</span>
<span class="sd">        IRIGTime : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is &#39;&#39;.</span>
<span class="sd">        verbose : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output_struct : np.ndarray</span>
<span class="sd">            A numpy structured array that can be saved to a mat file using</span>
<span class="sd">            scipy.io.savemat.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flat_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;FunctionType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;Version&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;SetRecord&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ResponseCoord&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ReferenceCoord&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;IDLine1&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;IDLine2&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;IDLine3&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;IDLine4&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;CreateDate&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ModifyDate&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OwnerName&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;Abscissa&#39;</span><span class="p">,</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span><span class="p">,)),</span>
                 <span class="p">(</span><span class="s1">&#39;Ordinate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span><span class="p">)),</span>
                 <span class="p">(</span><span class="s1">&#39;AbscissaDataType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;AbscissaTypeQual&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;AbscissaExpLength&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;AbscissaExpForce&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;AbscissaExpTemp&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;AbscissaExpTime&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;AbscissaAxisLab&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;AbscissaUnitsLab&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdinateType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdNumDataType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdNumTypeQual&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdNumExpLength&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdNumExpForce&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdNumExpTemp&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdNumExpTime&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdDenDataType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdDenTypeQual&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdDenExpLength&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdDenExpForce&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdDenExpTemp&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdDenExpTime&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdinateAxisLab&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OrdinateUnitsLab&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZAxisDataType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZAxisTypeQual&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZAxisExpLength&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZAxisExpForce&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZAxisExpTemp&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZAxisExpTime&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZGeneralValue&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZRPMValue&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZTimeValue&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ZOrderValue&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;UserValue1&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;UserValue2&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;UserValue3&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;UserValue4&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;SamplingType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;WeightingType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;WindowType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;AmplitudeUnits&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;Normalization&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OctaveFormat&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;OctaveAvgType&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;ExpDampingFact&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;PulsesPerRev&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;MeasurementRun&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;LoadCase&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span>
                 <span class="p">(</span><span class="s1">&#39;IRIGTime&#39;</span><span class="p">,</span> <span class="nb">object</span><span class="p">)</span>
                 <span class="p">]</span>
        <span class="n">output_struct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                                 <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Looping through functions for initial data&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flat_self</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">fn</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
                <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;ResponseCoord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">coordinate</span><span class="p">)</span>
                <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;ReferenceCoord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;ResponseCoord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">fn</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;ReferenceCoord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;ReferenceCoord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Abscissa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">abscissa</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Ordinate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">ordinate</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;IDLine1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">comment1</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;IDLine2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">comment2</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;IDLine3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">comment3</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;IDLine4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fn</span><span class="o">.</span><span class="n">comment4</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;FunctionType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_imat_function_type_inverse_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">function_type</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning Version&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;Version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">Version</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning SetRecord&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;SetRecord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">SetRecord</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">CreateDate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">CreateDate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%y    %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning CreateDate&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;CreateDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">CreateDate</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ModifyDate</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ModifyDate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%y    %H:%M:%S&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning Modify Date&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ModifyDate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">ModifyDate</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning OwnerName&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OwnerName&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OwnerName</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1"># Abscissa</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning Abscissa Data&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AbscissaDataType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_specific_data_names_vectorized</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaDataType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AbscissaTypeQual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_type_qual_names_vectorized</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaTypeQual</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaTypeQual</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaDataType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))):</span>
            <span class="n">exponents</span> <span class="o">=</span> <span class="n">_exponent_table</span><span class="p">[</span><span class="n">datatype</span><span class="p">]</span>
            <span class="p">(</span><span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AbscissaExpLength&#39;</span><span class="p">],</span> <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AbscissaExpForce&#39;</span><span class="p">],</span>
             <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AbscissaExpTemp&#39;</span><span class="p">],</span> <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AbscissaExpTime&#39;</span><span class="p">]</span>
             <span class="p">)</span> <span class="o">=</span> <span class="n">exponents</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="k">if</span> <span class="n">qual</span> <span class="o">==</span> <span class="n">TypeQual</span><span class="o">.</span><span class="n">ROTATION</span> <span class="k">else</span> <span class="n">exponents</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AbscissaAxisLab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaAxisLab</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AbscissaUnitsLab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaUnitsLab</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning Ordinate Numerator Data&#39;</span><span class="p">)</span>
        <span class="c1"># Ordinate Numerator</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdNumDataType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_specific_data_names_vectorized</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OrdNumDataType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdNumTypeQual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_type_qual_names_vectorized</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OrdNumTypeQual</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaTypeQual</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaDataType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))):</span>
            <span class="n">exponents</span> <span class="o">=</span> <span class="n">_exponent_table</span><span class="p">[</span><span class="n">datatype</span><span class="p">]</span>
            <span class="p">(</span><span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdNumExpLength&#39;</span><span class="p">],</span> <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdNumExpForce&#39;</span><span class="p">],</span>
             <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdNumExpTemp&#39;</span><span class="p">],</span> <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdNumExpTime&#39;</span><span class="p">]</span>
             <span class="p">)</span> <span class="o">=</span> <span class="n">exponents</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="k">if</span> <span class="n">qual</span> <span class="o">==</span> <span class="n">TypeQual</span><span class="o">.</span><span class="n">ROTATION</span> <span class="k">else</span> <span class="n">exponents</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
        <span class="c1"># Ordinate Denominator</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning Ordinate Denominator Data&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdDenDataType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_specific_data_names_vectorized</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OrdDenDataType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdDenTypeQual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_type_qual_names_vectorized</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OrdDenTypeQual</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaTypeQual</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaDataType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))):</span>
            <span class="n">exponents</span> <span class="o">=</span> <span class="n">_exponent_table</span><span class="p">[</span><span class="n">datatype</span><span class="p">]</span>
            <span class="p">(</span><span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdDenExpLength&#39;</span><span class="p">],</span> <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdDenExpForce&#39;</span><span class="p">],</span>
             <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdDenExpTemp&#39;</span><span class="p">],</span> <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdDenExpTime&#39;</span><span class="p">]</span>
             <span class="p">)</span> <span class="o">=</span> <span class="n">exponents</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="k">if</span> <span class="n">qual</span> <span class="o">==</span> <span class="n">TypeQual</span><span class="o">.</span><span class="n">ROTATION</span> <span class="k">else</span> <span class="n">exponents</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdinateAxisLab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OrdinateAxisLab</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdinateUnitsLab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OrdinateUnitsLab</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;complex128&#39;</span><span class="p">:</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdinateType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="s1">&#39;Complex Double&#39;</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;complex64&#39;</span><span class="p">:</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdinateType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="s1">&#39;Complex Single&#39;</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;float64&#39;</span><span class="p">:</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdinateType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="s1">&#39;Real Double&#39;</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;float32&#39;</span><span class="p">:</span>
            <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OrdinateType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="s1">&#39;Real Single&#39;</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1"># Z Axis</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning ZAxis Data&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZAxisDataType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_specific_data_names_vectorized</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">ZAxisDataType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZAxisTypeQual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_type_qual_names_vectorized</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">ZAxisTypeQual</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">qual</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaTypeQual</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AbscissaDataType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">))):</span>
            <span class="n">exponents</span> <span class="o">=</span> <span class="n">_exponent_table</span><span class="p">[</span><span class="n">datatype</span><span class="p">]</span>
            <span class="p">(</span><span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZAxisExpLength&#39;</span><span class="p">],</span> <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZAxisExpForce&#39;</span><span class="p">],</span>
             <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZAxisExpTemp&#39;</span><span class="p">],</span> <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZAxisExpTime&#39;</span><span class="p">]</span>
             <span class="p">)</span> <span class="o">=</span> <span class="n">exponents</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="k">if</span> <span class="n">qual</span> <span class="o">==</span> <span class="n">TypeQual</span><span class="o">.</span><span class="n">ROTATION</span> <span class="k">else</span> <span class="n">exponents</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZGeneralValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">ZGeneralValue</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZRPMValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">ZRPMValue</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZOrderValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">ZOrderValue</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ZTimeValue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">ZTimeValue</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning User Values&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;UserValue1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">UserValue1</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;UserValue2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">UserValue2</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;UserValue3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">UserValue3</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;UserValue4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">UserValue4</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Assigning Misc Data&#39;</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;SamplingType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">SamplingType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;WeightingType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">WeightingType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;WindowType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">WindowType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;AmplitudeUnits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">AmplitudeUnits</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;Normalization&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">Normalization</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OctaveFormat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OctaveFormat</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;OctaveAvgType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">OctaveAvgType</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;ExpDampingFact&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">ExpDampingFact</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;PulsesPerRev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">PulsesPerRev</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;MeasurementRun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">MeasurementRun</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;LoadCase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">LoadCase</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">output_struct</span><span class="p">[</span><span class="s1">&#39;IRIGTime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">IRIGTime</span><span class="p">,</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output_struct</span></div>
    
<div class="viewcode-block" id="NDDataArray.save"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the array to a numpy file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Filename that the array will be saved to.  Will be appended with</span>
<span class="sd">            .npz if not specified in the filename</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span>
                 <span class="n">function_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">function_type</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="NDDataArray.load"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.load">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load in the specified file into a SDynPy array object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : str</span>
<span class="sd">            Filename specifying the file to load.  If the filename has </span>
<span class="sd">            extension .unv or .uff, it will be loaded as a universal file.</span>
<span class="sd">            Otherwise, it will be loaded as a NumPy file.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            Raised if a unv file is loaded from a class that does not have a</span>
<span class="sd">            from_unv attribute defined.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cls</span>
<span class="sd">            SDynpy array of the appropriate type from the loaded file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.unv&#39;</span><span class="p">,</span> <span class="s1">&#39;.uff&#39;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">..fileio.sdynpy_uff</span> <span class="kn">import</span> <span class="n">readunv</span>
                <span class="n">unv_dict</span> <span class="o">=</span> <span class="n">readunv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_unv</span><span class="p">(</span><span class="n">unv_dict</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;Class </span><span class="si">{:}</span><span class="s1"> has no from_unv attribute defined&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">cls</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fn_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">fn_data</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span>
                <span class="n">_function_type_class_map</span><span class="p">[</span><span class="n">FunctionTypes</span><span class="p">(</span><span class="n">fn_data</span><span class="p">[</span><span class="s1">&#39;function_type&#39;</span><span class="p">])])</span></div>

<div class="viewcode-block" id="NDDataArray.to_imat_struct"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.to_imat_struct">[docs]</a>    <span class="k">def</span> <span class="nf">to_imat_struct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">SetRecord</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">CreateDate</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ModifyDate</span><span class="p">:</span> <span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">OwnerName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">AbscissaDataType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">AbscissaTypeQual</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">AbscissaAxisLab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">AbscissaUnitsLab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">OrdNumDataType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">OrdNumTypeQual</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">OrdDenDataType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">OrdDenTypeQual</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">OrdinateAxisLab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">OrdinateUnitsLab</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">ZAxisDataType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ZAxisTypeQual</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">ZGeneralValue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ZRPMValue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ZOrderValue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ZTimeValue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">UserValue1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">UserValue2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">UserValue3</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">UserValue4</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">SamplingType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">WeightingType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">WindowType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">AmplitudeUnits</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">Normalization</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">OctaveFormat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">OctaveAvgType</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ExpDampingFact</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">PulsesPerRev</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">MeasurementRun</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">LoadCase</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">IRIGTime</span><span class="o">=</span><span class="kc">None</span>
                       <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Matlab structure that can be read the IMAT toolbox.</span>

<span class="sd">        This structure can be read by the IMAT toolbox in Matlab to create an</span>
<span class="sd">        imat_fn object.  Note this is generally a faster function than</span>
<span class="sd">        to_imat_struct_array.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Version : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        SetRecord : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        CreateDate : datetime, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        ModifyDate : datetime, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OwnerName : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        AbscissaDataType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        AbscissaTypeQual : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        AbscissaAxisLab : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        AbscissaUnitsLab : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OrdNumDataType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OrdNumTypeQual : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OrdDenDataType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OrdDenTypeQual : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OrdinateAxisLab : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OrdinateUnitsLab : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        ZAxisDataType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        ZAxisTypeQual : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        ZGeneralValue : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        ZRPMValue : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        ZOrderValue : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        ZTimeValue : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        UserValue1 : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        UserValue2 : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        UserValue3 : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        UserValue4 : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        SamplingType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        WeightingType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        WindowType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        AmplitudeUnits : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        Normalization : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OctaveFormat : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        OctaveAvgType : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        ExpDampingFact : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        PulsesPerRev : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        MeasurementRun : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        LoadCase : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>
<span class="sd">        IRIGTime : TYPE, optional</span>
<span class="sd">            DESCRIPTION. The default is None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        data_dict : TYPE</span>
<span class="sd">            DESCRIPTION.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span> <span class="o">==</span>
                     <span class="s1">&#39;self&#39;</span><span class="p">}</span>  <span class="c1"># Get all the local variables that have been defined</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Ordinate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;Abscissa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDLine1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment1</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDLine2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment2</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDLine3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment3</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;IDLine4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment4</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;ResponseCoord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_coordinate</span><span class="o">.</span><span class="n">string_array</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;ReferenceCoord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reference_coordinate</span><span class="o">.</span><span class="n">string_array</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;FunctionType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_imat_function_type_inverse_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">function_type</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">argument</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">arguments</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">datetime</span><span class="p">):</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%y    %H:%M:%S&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">SpecificDataType</span><span class="p">):</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">argument</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">return</span> <span class="n">data_dict</span></div>

    <span class="c1"># def to_unv(self,function_id=1,version_number=1,load_case = 0,</span>
    <span class="c1">#            response_entity_name = None,reference_entity_name = None,</span>
    <span class="c1">#            abscissa_data_type = None,abscissa_length_exponent = None,</span>
    <span class="c1">#            abscissa_force_exponent = None, abscissa_temp_exponent = None,</span>
    <span class="c1">#            abscissa_axis_label = None,abscissa_units_label = None,</span>
    <span class="c1">#            ordinate_num_data_type = None,ordinate_num_length_exponent = None,</span>
    <span class="c1">#            ordinate_num_force_exponent = None,ordinate_num_temp_exponent = None,</span>
    <span class="c1">#            ordinate_num_axis_label = None,ordinate_num_units_label = None,</span>
    <span class="c1">#            ordinate_den_data_type = None,ordinate_den_length_exponent = None,</span>
    <span class="c1">#            ordinate_den_force_exponent = None,ordinate_den_temp_exponent = None,</span>
    <span class="c1">#            ordinate_den_axis_label = None,ordinate_den_units_label = None,</span>
    <span class="c1">#            zaxis_data_type = None,zaxis_length_exponent = None,</span>
    <span class="c1">#            zaxis_force_exponent = None,zaxis_temp_exponent = None,</span>
    <span class="c1">#            zaxis_axis_label = None,zaxis_units_label = None,zaxis_value= None):</span>
    <span class="c1">#     unv_data_dict = {58:[]}</span>
    <span class="c1">#     for key,func in self.ndenumerate():</span>
    <span class="c1">#         dataset_58 = sdpy.unv.dataset_58.Sdynpy_UFF_Dataset_58(</span>
    <span class="c1">#             func.comment1,func.comment2,func.comment3,func.comment4,</span>
    <span class="c1">#             func.comment5,func.function_type.value,)</span>

<div class="viewcode-block" id="NDDataArray.from_unv"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.NDDataArray.html#sdynpy.core.sdynpy_data.NDDataArray.from_unv">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_unv</span><span class="p">(</span><span class="n">unv_data_dict</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a data array from a unv dictionary from read_unv</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        unv_data_dict : dict</span>
<span class="sd">            Dictionary containing data from read_unv</span>
<span class="sd">        squeeze : bool, optional</span>
<span class="sd">            Automatically reduce dimension of the read data if possible.</span>
<span class="sd">            The default is True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        return_functions : NDDataArray</span>
<span class="sd">            Data read from unv</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fn_datasets</span> <span class="o">=</span> <span class="n">unv_data_dict</span><span class="p">[</span><span class="mi">58</span><span class="p">]</span>
        <span class="n">fn_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="o">.</span><span class="n">function_type</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">fn_datasets</span><span class="p">]</span>
        <span class="n">function_type_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">fn_dataset</span><span class="p">,</span> <span class="n">fn_type</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fn_datasets</span><span class="p">,</span> <span class="n">fn_types</span><span class="p">):</span>
            <span class="n">fn_type_enum</span> <span class="o">=</span> <span class="n">FunctionTypes</span><span class="p">(</span><span class="n">fn_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fn_type_enum</span> <span class="ow">in</span> <span class="n">function_type_dict</span><span class="p">:</span>
                <span class="n">function_type_dict</span><span class="p">[</span><span class="n">fn_type_enum</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">function_type_dict</span><span class="p">[</span><span class="n">fn_type_enum</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fn_dataset</span><span class="p">)</span>
        <span class="n">return_functions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">function_list</span> <span class="ow">in</span> <span class="n">function_type_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">abscissa</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ordinate</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">coordinate</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">comment1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">comment2</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">comment3</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">comment4</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">comment5</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">function_list</span><span class="p">:</span>
                <span class="n">abscissa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">abscissa</span><span class="p">)</span>
                <span class="n">ordinate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">ordinate</span><span class="p">)</span>
                <span class="n">coordinate</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">response_node</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">response_direction</span><span class="p">),</span>
                                   <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">reference_node</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">reference_direction</span><span class="p">)))</span>
                <span class="n">comment1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">idline1</span><span class="p">)</span>
                <span class="n">comment2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">idline2</span><span class="p">)</span>
                <span class="n">comment3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">idline3</span><span class="p">)</span>
                <span class="n">comment4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">idline4</span><span class="p">)</span>
                <span class="n">comment5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">idline5</span><span class="p">)</span>
            <span class="n">return_functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">data_array</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abscissa</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ordinate</span><span class="p">),</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinate</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">CoordinateArray</span><span class="p">),</span>
                           <span class="n">comment1</span><span class="p">,</span>
                           <span class="n">comment2</span><span class="p">,</span>
                           <span class="n">comment3</span><span class="p">,</span>
                           <span class="n">comment4</span><span class="p">,</span>
                           <span class="n">comment5</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_functions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">squeeze</span><span class="p">:</span>
            <span class="n">return_functions</span> <span class="o">=</span> <span class="n">return_functions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">return_functions</span></div>

    <span class="n">from_uff</span> <span class="o">=</span> <span class="n">from_unv</span></div>


<div class="viewcode-block" id="TimeHistoryArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TimeHistoryArray.html#sdynpy.core.sdynpy_data.TimeHistoryArray">[docs]</a><span class="k">class</span> <span class="nc">TimeHistoryArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store time history data&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TIME_RESPONSE</span>

<div class="viewcode-block" id="TimeHistoryArray.from_exodus"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TimeHistoryArray.html#sdynpy.core.sdynpy_data.TimeHistoryArray.from_exodus">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_exodus</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">exo</span><span class="p">,</span> <span class="n">x_disp</span><span class="o">=</span><span class="s1">&#39;DispX&#39;</span><span class="p">,</span> <span class="n">y_disp</span><span class="o">=</span><span class="s1">&#39;DispY&#39;</span><span class="p">,</span> <span class="n">z_disp</span><span class="o">=</span><span class="s1">&#39;DispZ&#39;</span><span class="p">,</span> <span class="n">x_rot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_rot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z_rot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timesteps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads time data from displacements in an Exodus file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        exo : Exodus or ExodusInMemory</span>
<span class="sd">            The exodus data from which geometry will be created.</span>
<span class="sd">        x_disp : str, optional</span>
<span class="sd">            String denoting the nodal variable in the exodus file from which</span>
<span class="sd">            the X-direction displacement should be read. The default is &#39;DispX&#39;.</span>
<span class="sd">        y_disp : str, optional</span>
<span class="sd">            String denoting the nodal variable in the exodus file from which</span>
<span class="sd">            the Y-direction displacement should be read. The default is &#39;DispY&#39;.</span>
<span class="sd">        z_disp : str, optional</span>
<span class="sd">            String denoting the nodal variable in the exodus file from which</span>
<span class="sd">            the Z-direction displacement should be read. The default is &#39;DispZ&#39;.</span>
<span class="sd">        timesteps : iterable, optional</span>
<span class="sd">            A list of timesteps from which data should be read. The default is</span>
<span class="sd">            None, which reads all timesteps.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TYPE</span>
<span class="sd">            DESCRIPTION.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exo</span><span class="p">,</span> <span class="n">Exodus</span><span class="p">):</span>
            <span class="n">node_ids</span> <span class="o">=</span> <span class="n">exo</span><span class="o">.</span><span class="n">get_node_num_map</span><span class="p">()</span>
            <span class="n">variables</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">x_disp</span><span class="p">,</span> <span class="n">y_disp</span><span class="p">,</span>
                                                           <span class="n">z_disp</span><span class="p">,</span> <span class="n">x_rot</span><span class="p">,</span> <span class="n">y_rot</span><span class="p">,</span> <span class="n">z_rot</span><span class="p">])</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]</span>
            <span class="n">abscissa</span> <span class="o">=</span> <span class="n">exo</span><span class="o">.</span><span class="n">get_times</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TIME_RESPONSE</span><span class="p">,</span> <span class="n">abscissa</span><span class="p">,</span>
                               <span class="n">exo</span><span class="o">.</span><span class="n">get_node_variable_values</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">timesteps</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                               <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span><span class="n">node_ids</span><span class="p">,</span> <span class="n">index</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO need to add in rotations</span>
            <span class="n">node_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                <span class="n">exo</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">exo</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">node_num_map</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">exo</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">node_num_map</span>
            <span class="n">x_var</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">exo</span><span class="o">.</span><span class="n">nodal_vars</span> <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">x_disp</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span>
            <span class="p">)][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">timesteps</span><span class="p">)</span> <span class="k">if</span> <span class="n">timesteps</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">timesteps</span><span class="p">]</span>
            <span class="n">y_var</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">exo</span><span class="o">.</span><span class="n">nodal_vars</span> <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">y_disp</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span>
            <span class="p">)][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">timesteps</span><span class="p">)</span> <span class="k">if</span> <span class="n">timesteps</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">timesteps</span><span class="p">]</span>
            <span class="n">z_var</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">exo</span><span class="o">.</span><span class="n">nodal_vars</span> <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">z_disp</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span>
            <span class="p">)][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">timesteps</span><span class="p">)</span> <span class="k">if</span> <span class="n">timesteps</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">timesteps</span><span class="p">]</span>
            <span class="n">abscissa</span> <span class="o">=</span> <span class="n">exo</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="n">timesteps</span><span class="p">)</span> <span class="k">if</span> <span class="n">timesteps</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">timesteps</span><span class="p">]</span>
            <span class="n">ordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x_var</span><span class="p">,</span> <span class="n">y_var</span><span class="p">,</span> <span class="n">z_var</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span>
                <span class="n">node_ids</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TIME_RESPONSE</span><span class="p">,</span> <span class="n">abscissa</span><span class="p">,</span> <span class="n">ordinate</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span></div>

<div class="viewcode-block" id="TimeHistoryArray.fft"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TimeHistoryArray.html#sdynpy.core.sdynpy_data.TimeHistoryArray.fft">[docs]</a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples_per_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the frequency spectra of the time signal</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        samples_per_frame : int, optional</span>
<span class="sd">            Number of samples per measurement frame.  If this is specified, then</span>
<span class="sd">            the signal will be split up into frames and averaged together.  Be</span>
<span class="sd">            aware that if the time signal is not periodic, averaging it may have</span>
<span class="sd">            the effect of zeroing out the spectrum (because the average time</span>
<span class="sd">            signal is zero). The default is no averaging, the frame size is the</span>
<span class="sd">            length of the signal.</span>
<span class="sd">        scaling : str, optional</span>
<span class="sd">            The type of scaling applied to the output spectra.  This is not</span>
<span class="sd">            implemented yet. The default is None.</span>
<span class="sd">        rtol : float, optional</span>
<span class="sd">            Relative tolerance used in the abcsissa spacing check.</span>
<span class="sd">            The default is 1e-5.</span>
<span class="sd">        atol : float, optional</span>
<span class="sd">            Relative tolerance used in the abscissa spacing check.</span>
<span class="sd">            The default is 1e-8.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if the time signal passed to this function does not have</span>
<span class="sd">            equally spaced abscissa.</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            Raised if the user specifies scaling.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SpectrumArray</span>
<span class="sd">            The frequency spectra of the TimeHistoryArray.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">diffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Abscissa must have identical spacing to perform the FFT&#39;</span><span class="p">)</span>
        <span class="n">ordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">samples_per_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frame_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples_per_frame</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ordinate</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span>
                                                                     <span class="n">samples_per_frame</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">samples_per_frame</span>
            <span class="n">ordinate</span> <span class="o">=</span> <span class="n">ordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">frame_indices</span><span class="p">]</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">ordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">ordinate</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">scaling</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Scaling is not implemented yet.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">samples_per_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ordinate</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># Create the output signal</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">,</span> <span class="n">frequencies</span><span class="p">,</span> <span class="n">ordinate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">comment1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment5</span><span class="p">)</span></div>

<div class="viewcode-block" id="TimeHistoryArray.cpsd"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TimeHistoryArray.html#sdynpy.core.sdynpy_data.TimeHistoryArray.cpsd">[docs]</a>    <span class="k">def</span> <span class="nf">cpsd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples_per_frame</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">overlap</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
             <span class="n">averages_to_keep</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">only_asds</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a CPSD matrix from the time histories</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        samples_per_frame : int</span>
<span class="sd">            Number of samples per frame</span>
<span class="sd">        overlap : float</span>
<span class="sd">            Overlap fraction (not percent, e.g. 0.5 not 50)</span>
<span class="sd">        window : str</span>
<span class="sd">            Name of a window function in scipy.signal.windows</span>
<span class="sd">        averages_to_keep : int, optional</span>
<span class="sd">            Optional number of averages to use, otherwise as many as possible</span>
<span class="sd">            will be used.</span>
<span class="sd">        only_asds : bool, optional</span>
<span class="sd">            If True, only compute autospectral densities (diagonal of the</span>
<span class="sd">            CPSD matrix)</span>
<span class="sd">        rtol : float, optional</span>
<span class="sd">            Tolerance used to check abscissa spacing. The default is 1.</span>
<span class="sd">        atol : float, optional</span>
<span class="sd">            Tolerance used to check abscissa spacing. The default is 1e-8.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If time history abscissa are not equally spaced.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cpsd_array : PowerSpectralDensityArray</span>
<span class="sd">            Cross Power Spectral Density Array.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">diffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Abscissa must have identical spacing to perform the cpsd&#39;</span><span class="p">)</span>
        <span class="n">flat_self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">response_coordinate</span>
        <span class="n">ordinate</span> <span class="o">=</span> <span class="n">flat_self</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="n">df</span><span class="p">,</span> <span class="n">cpsd_matrix</span> <span class="o">=</span> <span class="n">sp_cpsd</span><span class="p">(</span><span class="n">ordinate</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diffs</span><span class="p">),</span> <span class="n">samples_per_frame</span><span class="p">,</span>
                                  <span class="n">overlap</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">averages_to_keep</span><span class="p">,</span> <span class="n">only_asds</span><span class="p">)</span>
        <span class="c1">#  Construct the spectrum array</span>
        <span class="n">abscissa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cpsd_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">df</span>
        <span class="n">cpsd_array</span> <span class="o">=</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span><span class="p">,</span> <span class="n">abscissa</span><span class="p">,</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">cpsd_matrix</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">coords</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="k">if</span> <span class="n">only_asds</span>
                                <span class="k">else</span> <span class="n">outer_product</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">coords</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">cpsd_array</span></div>

<div class="viewcode-block" id="TimeHistoryArray.rms"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TimeHistoryArray.html#sdynpy.core.sdynpy_data.TimeHistoryArray.rms">[docs]</a>    <span class="k">def</span> <span class="nf">rms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span></div></div>


<span class="c1"># def time_history_array(abscissa,ordinate,coordinate,comment1=&#39;&#39;,comment2=&#39;&#39;,comment3=&#39;&#39;,comment4=&#39;&#39;,comment5=&#39;&#39;):</span>
<span class="c1">#     pass</span>

<div class="viewcode-block" id="SpectrumArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.SpectrumArray.html#sdynpy.core.sdynpy_data.SpectrumArray">[docs]</a><span class="k">class</span> <span class="nc">SpectrumArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store linear spectra (for example scaled FFT results)&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;complex128&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">SPECTRUM</span>

<div class="viewcode-block" id="SpectrumArray.ifft"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.SpectrumArray.html#sdynpy.core.sdynpy_data.SpectrumArray.ifft">[docs]</a>    <span class="k">def</span> <span class="nf">ifft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a time signal from the frequency spectrum</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scaling : str, optional</span>
<span class="sd">            The type of scaling applied to the output spectra.  This is not</span>
<span class="sd">            implemented yet. The default is None.</span>
<span class="sd">        rtol : float, optional</span>
<span class="sd">            Relative tolerance used in the abcsissa spacing check.</span>
<span class="sd">            The default is 1e-5.</span>
<span class="sd">        atol : float, optional</span>
<span class="sd">            Relative tolerance used in the abscissa spacing check.</span>
<span class="sd">            The default is 1e-8.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if the spectra passed to this function do not have</span>
<span class="sd">            equally spaced abscissa.</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            Raised if the user specifies scaling.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TimeHistoryArray</span>
<span class="sd">            The time history of the SpectrumArray.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">diffs</span><span class="p">,</span> <span class="n">diffs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Abscissa must have identical spacing to perform the FFT&#39;</span><span class="p">)</span>
        <span class="n">ordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">scaling</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Scaling is not implemented yet.&#39;</span><span class="p">)</span>
        <span class="n">ordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">irfft</span><span class="p">(</span><span class="n">ordinate</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">abscissa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TIME_RESPONSE</span><span class="p">,</span> <span class="n">abscissa</span><span class="p">,</span> <span class="n">ordinate</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">comment1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment5</span><span class="p">)</span></div>

<div class="viewcode-block" id="SpectrumArray.plot"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.SpectrumArray.html#sdynpy.core.sdynpy_data.SpectrumArray.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">one_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subplots_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">plot_kwargs</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the transfer functions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        one_axis : bool, optional</span>
<span class="sd">            Set to True to plot all data on one axis.  Set to False to plot</span>
<span class="sd">            data on multiple subplots.  one_axis can also be set to a </span>
<span class="sd">            matplotlib axis to plot data on an existing axis.  The default is</span>
<span class="sd">            True.</span>
<span class="sd">        subplots_kwargs : dict, optional</span>
<span class="sd">            Keywords passed to the matplotlib subplots function to create the</span>
<span class="sd">            figure and axes. The default is {}.</span>
<span class="sd">        plot_kwargs : dict, optional</span>
<span class="sd">            Keywords passed to the matplotlib plot function. The default is {}.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        axis : matplotlib axis or array of axes</span>
<span class="sd">             On which the data were plotted</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">one_axis</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">subplots_kwargs</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase&#39;</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">one_axis</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="o">**</span><span class="n">subplots_kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">function</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">())):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">function</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">()]))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axis</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">one_axis</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axis</span></div></div>

<span class="c1"># def spectrum_array(abscissa,ordinate,coordinate,comment1=&#39;&#39;,comment2=&#39;&#39;,comment3=&#39;&#39;,comment4=&#39;&#39;,comment5=&#39;&#39;):</span>
<span class="c1">#     pass</span>


<div class="viewcode-block" id="PowerSpectralDensityArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray">[docs]</a><span class="k">class</span> <span class="nc">PowerSpectralDensityArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store power spectral density arrays&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;complex128&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span>

<div class="viewcode-block" id="PowerSpectralDensityArray.generate_time_history"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.generate_time_history">[docs]</a>    <span class="k">def</span> <span class="nf">generate_time_history</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_oversample</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a time history from a CPSD matrix</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time_length : float, optional</span>
<span class="sd">            The length (in time, not samples) of the signal.  If not specified,</span>
<span class="sd">            the signal length will be based on the frequency spacing and</span>
<span class="sd">            nyquist frequency of the CPSD matrix.  If specified, a signal will</span>
<span class="sd">            be constructed using constant overlap and add techniques.  A whole</span>
<span class="sd">            number of realizations will be constructed, so the output signal</span>
<span class="sd">            can be longer than the `time_length` specified.</span>
<span class="sd">        output_oversample : int, optional</span>
<span class="sd">            Oversample factor applied to the output signal. The default is 1.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the entries in the CPSD matrix do not have consistent abscissa</span>
<span class="sd">            or equally spaced frequency bins.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        time_history : TimeHistoryArray</span>
<span class="sd">            A time history satisfying the properties of the CPSD matrix.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matrix_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">matrix_format</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">response_coordinate</span>
        <span class="n">cpsd_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">matrix_format</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_common_abscissa</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All functions in CPSD matrix must have the same abscissa&#39;</span><span class="p">)</span>
        <span class="n">abs_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">matrix_format</span><span class="o">.</span><span class="n">abscissa</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">abs_diff</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">abs_diff</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Abscissa must have constant frequency spacing.  Max </span><span class="si">{:}</span><span class="s1">, Min </span><span class="si">{:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">abs_diff</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">abs_diff</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
        <span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">matrix_format</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">realization_length</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">df</span>
        <span class="k">if</span> <span class="n">time_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">realizations</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">realizations</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">time_length</span> <span class="o">/</span> <span class="n">realization_length</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="c1"># Do constant overlap and add</span>
        <span class="n">final_signals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">coordinates</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="p">(</span><span class="n">realizations</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span>
                                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">output_oversample</span><span class="p">))</span>
        <span class="n">window_function</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">hann</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">output_oversample</span><span class="p">,</span> <span class="n">sym</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">window_first_half</span> <span class="o">=</span> <span class="n">window_function</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">window_first_half</span><span class="p">[</span><span class="n">window_first_half</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">window_second_half</span> <span class="o">=</span> <span class="n">window_function</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">window_second_half</span><span class="p">[:</span><span class="n">window_second_half</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">realizations</span><span class="p">):</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">output_oversample</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_elements</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">output_oversample</span><span class="p">)</span>
            <span class="n">realization</span> <span class="o">=</span> <span class="n">cpsd_to_time_history</span><span class="p">(</span><span class="n">cpsd_matrix</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">output_oversample</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">realization</span> <span class="o">*=</span> <span class="n">window_first_half</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">realizations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">realization</span> <span class="o">*=</span> <span class="n">window_second_half</span>
            <span class="n">final_signals</span><span class="p">[:,</span> <span class="n">indices</span><span class="p">]</span> <span class="o">+=</span> <span class="n">realization</span>
        <span class="c1"># Create time history array</span>
        <span class="n">abscissa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">final_signals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">sample_rate</span> <span class="o">/</span> <span class="n">output_oversample</span>
        <span class="n">time_history</span> <span class="o">=</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TIME_RESPONSE</span><span class="p">,</span> <span class="n">abscissa</span><span class="p">,</span>
                                  <span class="n">final_signals</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">time_history</span></div>

<div class="viewcode-block" id="PowerSpectralDensityArray.mimo_forward"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.mimo_forward">[docs]</a>    <span class="k">def</span> <span class="nf">mimo_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transfer_function</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the forward MIMO problem Gxx = Hxv@Gvv@Hxv*</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        transfer_function : TransferFunctionArray</span>
<span class="sd">            Transfer function used to transform the input matrix to the</span>
<span class="sd">            response matrix</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If abscissa do not match between self and transfer function</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PowerSpectralDensityArray</span>
<span class="sd">            Response CPSD matrix</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check consistent abscissa</span>
        <span class="n">abscissa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">abscissa</span><span class="p">,</span><span class="n">transfer_function</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Transfer Function Abscissa do not match CPSD&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">abscissa</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All CPSD abscissa must be identical&#39;</span><span class="p">)</span>
        <span class="c1"># First do bookkeeping, we want to get the coordinates of the response</span>
        <span class="c1"># of the FRF corresponding to the specification matrix</span>
        <span class="n">transfer_function</span> <span class="o">=</span> <span class="n">transfer_function</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span>
        <span class="n">response_dofs</span> <span class="o">=</span> <span class="n">transfer_function</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">response_coordinate</span>
        <span class="n">reference_dofs</span> <span class="o">=</span> <span class="n">transfer_function</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">reference_coordinate</span>
        <span class="n">cpsd_dofs</span> <span class="o">=</span> <span class="n">outer_product</span><span class="p">(</span><span class="n">reference_dofs</span><span class="p">,</span><span class="n">reference_dofs</span><span class="p">)</span>
        <span class="n">output_dofs</span><span class="o">=</span> <span class="n">outer_product</span><span class="p">(</span><span class="n">response_dofs</span><span class="p">,</span><span class="n">response_dofs</span><span class="p">)</span>
        <span class="n">frf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">transfer_function</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cpsd_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">cpsd_dofs</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">output_matrix</span> <span class="o">=</span> <span class="n">frf_matrix</span> <span class="o">@</span> <span class="n">cpsd_matrix</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">frf_matrix</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span><span class="p">,</span>
                          <span class="n">abscissa</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">output_matrix</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">output_dofs</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PowerSpectralDensityArray.mimo_inverse"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.mimo_inverse">[docs]</a>    <span class="k">def</span> <span class="nf">mimo_inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transfer_function</span><span class="p">,</span>
                     <span class="n">response_weighting_matrix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">excitation_weighting_matrix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">regularization_parameter</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">svd_regularization</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes input estimation for MIMO random vibration problems</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        transfer_function : TransferFunctionArray</span>
<span class="sd">            System transfer functions used to estimate the input from the given</span>
<span class="sd">            response matrix</span>
<span class="sd">        response_weighting_matrix : sdpy.Matrix or np.ndarray, optional</span>
<span class="sd">            Matrix used to weight response degrees of freedom.</span>
<span class="sd">        excitation_weighting_matrix : sdpy.Matrix or np.ndarray, optional</span>
<span class="sd">            Matrix used to weight input degrees of freedom</span>
<span class="sd">        regularization_parameter : float or np.ndarray, optional</span>
<span class="sd">            Scaling parameter used on the excitation weighting matrix</span>
<span class="sd">        svd_regularization : float, optional</span>
<span class="sd">            Condition number used for SVD truncation.  Can be used alternatively</span>
<span class="sd">            to the weighting matrices</span>


<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If Abscissa are not consistent</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PowerSpectralDensityArray</span>
<span class="sd">            Input CPSD matrix</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This function solves the MIMO problem Gxx = Hxv@Gvv@Hxv^* using the</span>
<span class="sd">        pseudoinverse.  Gvv = Hxv^+@Gxx@Hxv^+^*.  We compute the pseudoinverse</span>
<span class="sd">        Hxv^+ = (Hxv^T@W^T@W@Hxv + l*Z)^-1@Hxv^T@W^T</span>
<span class="sd">        where W is the response_weighting_matrix, Z is the excitation_weighting_matrix,</span>
<span class="sd">        and l is the regularization_parameter.  If these are not specified,</span>
<span class="sd">        the SVD regularization is used, where the svd_regularization parameter</span>
<span class="sd">        is passed as the rcond argument to np.linalg.pinv.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check consistent abscissa</span>
        <span class="n">abscissa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">abscissa</span><span class="p">,</span><span class="n">transfer_function</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Transfer Function Abscissa do not match CPSD&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">abscissa</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All CPSD abscissa must be identical&#39;</span><span class="p">)</span>
        <span class="c1"># First do bookkeeping, we want to get the coordinates of the response</span>
        <span class="c1"># of the FRF corresponding to the specification matrix</span>
        <span class="n">transfer_function</span> <span class="o">=</span> <span class="n">transfer_function</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span>
        <span class="n">response_dofs</span> <span class="o">=</span> <span class="n">transfer_function</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">response_coordinate</span>
        <span class="n">reference_dofs</span> <span class="o">=</span> <span class="n">transfer_function</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">reference_coordinate</span>
        <span class="n">cpsd_dofs</span> <span class="o">=</span> <span class="n">outer_product</span><span class="p">(</span><span class="n">response_dofs</span><span class="p">,</span><span class="n">response_dofs</span><span class="p">)</span>
        <span class="n">output_dofs</span><span class="o">=</span> <span class="n">outer_product</span><span class="p">(</span><span class="n">reference_dofs</span><span class="p">,</span><span class="n">reference_dofs</span><span class="p">)</span>
        <span class="n">frf_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">transfer_function</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cpsd_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">cpsd_dofs</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Perform the generalized inversion</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">response_weighting_matrix</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
            <span class="n">excitation_weighting_matrix</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span>
            <span class="n">regularization_parameter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">frf_pinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">frf_matrix</span><span class="p">,</span><span class="n">rcond</span><span class="o">=</span><span class="mf">1e-15</span> <span class="k">if</span> <span class="n">svd_regularization</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">svd_regularization</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">response_weighting_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response_weighting_matrix</span><span class="p">,</span><span class="n">Matrix</span><span class="p">):</span>
                    <span class="n">response_weighting_matrix</span> <span class="o">=</span> <span class="n">response_weighting_matrix</span><span class="p">[</span><span class="n">response_dofs</span><span class="p">,</span><span class="n">response_dofs</span><span class="p">]</span>
                <span class="n">frf_matrix</span> <span class="o">=</span> <span class="n">response_weighting_matrix</span><span class="nd">@frf_matrix</span>
                <span class="n">cpsd_matrix</span> <span class="o">=</span> <span class="n">response_weighting_matrix</span> <span class="o">@</span> <span class="n">cpsd_matrix</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">response_weighting_matrix</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">regularization_parameter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">regularization_parameter</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">excitation_weighting_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">excitation_weighting_matrix</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">excitation_weighting_matrix</span><span class="p">,</span><span class="n">Matrix</span><span class="p">):</span>
                <span class="n">excitation_weighting_matrix</span> <span class="o">=</span> <span class="n">excitation_weighting_matrix</span><span class="p">[</span><span class="n">reference_dofs</span><span class="p">,</span><span class="n">reference_dofs</span><span class="p">]</span>
            <span class="n">frf_matrix_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">frf_matrix</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">frf_pinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">((</span><span class="n">frf_matrix_H</span><span class="nd">@frf_matrix</span><span class="o">+</span><span class="n">regularization_parameter</span><span class="o">*</span><span class="n">excitation_weighting_matrix</span><span class="p">),</span><span class="n">frf_matrix_H</span><span class="p">)</span>
        <span class="n">output_matrix</span> <span class="o">=</span> <span class="n">frf_pinv</span> <span class="o">@</span> <span class="n">cpsd_matrix</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">frf_pinv</span><span class="o">.</span><span class="n">conj</span><span class="p">(),</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span><span class="p">,</span>
                          <span class="n">abscissa</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">output_matrix</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">output_dofs</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PowerSpectralDensityArray.error_summary"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.error_summary">[docs]</a>    <span class="k">def</span> <span class="nf">error_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">figure_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_kwargs</span><span class="o">=</span><span class="p">{},</span><span class="o">**</span><span class="n">cpsd_matrices</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots an error summary compared to the current array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figure_kwargs : dict, optional</span>
<span class="sd">            Arguments to use when creating the figure. The default is {}.</span>
<span class="sd">        linewidth : float, optional</span>
<span class="sd">            Widths of the lines on the plot. The default is 1.</span>
<span class="sd">        plot_kwargs : dict, optional</span>
<span class="sd">            Arguments to use when plotting the lines. The default is {}.</span>
<span class="sd">        **cpsd_matrices : PowerSpectralDensityArray</span>
<span class="sd">            Data to compare against the current CPSD matrix.  The keys will be</span>
<span class="sd">            used as labels with _ replaced with a space.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If CPSD abscissa do not match</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Error Metrics</span>
<span class="sd">            A tuple of dictionaries of error metrics</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">rms</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">))</span>
        <span class="k">def</span> <span class="nf">dB_pow</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">frequencies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span>
        <span class="k">for</span> <span class="n">legend</span><span class="p">,</span><span class="n">cpsd</span> <span class="ow">in</span> <span class="n">cpsd_matrices</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="n">cpsd</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Compared CPSD abscissa do not match&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All CPSD abscissa must be identical&#39;</span><span class="p">)</span>
        <span class="c1"># Get ASDs</span>
        <span class="n">responses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">))</span>
        <span class="n">response_dofs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">responses</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">channel_names</span> <span class="o">=</span> <span class="n">responses</span><span class="o">.</span><span class="n">string_array</span><span class="p">()</span>
        <span class="n">spec_asd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">response_dofs</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">)</span>
        <span class="n">data_asd</span> <span class="o">=</span> <span class="p">{</span><span class="n">legend</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">response_dofs</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">)</span> <span class="k">for</span> <span class="n">legend</span><span class="p">,</span><span class="n">data</span> <span class="ow">in</span> <span class="n">cpsd_matrices</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">num_channels</span> <span class="o">=</span> <span class="n">spec_asd</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_channels</span><span class="p">)))</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_channels</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpsd_matrices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">total_rows</span> <span class="o">=</span> <span class="n">nrows</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpsd_matrices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">total_rows</span> <span class="o">=</span> <span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">total_rows</span> <span class="o">=</span> <span class="n">nrows</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">figure_kwargs</span><span class="p">)</span>
        <span class="n">grid_spec</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">total_rows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_channels</span><span class="p">):</span>
            <span class="n">this_row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">ncols</span>
            <span class="n">this_col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">ncols</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">this_row</span><span class="p">,</span> <span class="n">this_col</span><span class="p">])</span>
                <span class="n">original_ax</span> <span class="o">=</span> <span class="n">ax</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">this_row</span><span class="p">,</span> <span class="n">this_col</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">original_ax</span><span class="p">,</span>
                                     <span class="n">sharey</span><span class="o">=</span><span class="n">original_ax</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">spec_asd</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">legend</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_asd</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">channel_names</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_row</span> <span class="o">==</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_col</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">return_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpsd_matrices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">spec_sum_asd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spec_asd</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">data_sum_asd</span> <span class="o">=</span> <span class="p">{</span><span class="n">legend</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">legend</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_asd</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">db_error</span> <span class="o">=</span> <span class="p">{</span><span class="n">legend</span><span class="p">:</span> <span class="n">rms</span><span class="p">(</span><span class="n">dB_pow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">dB_pow</span><span class="p">(</span><span class="n">spec_asd</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">legend</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_asd</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">plot_width</span> <span class="o">=</span> <span class="n">ncols</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">nrows</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">plot_width</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">spec_sum_asd</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">linewidth</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">legend</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">data_sum_asd</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sum ASDs&#39;</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">nrows</span><span class="p">,</span> <span class="o">-</span><span class="n">plot_width</span><span class="p">:])</span>
            <span class="k">for</span> <span class="n">legend</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">db_error</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;dB Error&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cpsd_matrices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">prop_cycle</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
            <span class="n">db_error_sum_asd</span> <span class="o">=</span> <span class="p">{</span><span class="n">legend</span><span class="p">:</span> <span class="n">rms</span><span class="p">(</span><span class="n">dB_pow</span><span class="p">(</span><span class="n">sum_asd</span><span class="p">)</span> <span class="o">-</span> <span class="n">dB_pow</span><span class="p">(</span><span class="n">spec_sum_asd</span><span class="p">))</span>
                                <span class="k">for</span> <span class="n">legend</span><span class="p">,</span> <span class="n">sum_asd</span> <span class="ow">in</span> <span class="n">data_sum_asd</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">db_error_rms</span> <span class="o">=</span> <span class="p">{</span><span class="n">legend</span><span class="p">:</span> <span class="n">rms</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">for</span> <span class="n">legend</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">db_error</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">return_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">db_error_sum_asd</span><span class="p">,</span> <span class="n">db_error_rms</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">plot_width</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">db_error_sum_asd</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">legend</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">legend</span> <span class="ow">in</span> <span class="n">db_error_sum_asd</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sum RMS dB Error&#39;</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">plot_width</span><span class="p">:])</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">legend</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">db_error_rms</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">legend</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">legend</span> <span class="ow">in</span> <span class="n">db_error_rms</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;RMS dB Error&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">return_data</span></div>

<div class="viewcode-block" id="PowerSpectralDensityArray.get_asd"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.get_asd">[docs]</a>    <span class="k">def</span> <span class="nf">get_asd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get functions where the response coordinate is equal to the reference coordinate</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PowerSpectralDensityArray</span>
<span class="sd">            PowerSpectralDensityArrays where the response is equal to the reference</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span></div>

<div class="viewcode-block" id="PowerSpectralDensityArray.rms"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.rms">[docs]</a>    <span class="k">def</span> <span class="nf">rms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute RMSs of the PSDs using the diagonals</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">            RMS values for the ASDS</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_asd</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">asd</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">real</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">asd</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span></div>

<div class="viewcode-block" id="PowerSpectralDensityArray.plot_asds"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.plot_asds">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">plot_asds</span><span class="p">(</span><span class="n">figure_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">**</span><span class="n">cpsd_matrices</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the diagonals of the CPSD matrix, as well as the level</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figure_kwargs : dict, optional</span>
<span class="sd">            Optional arguments to use when creating the figure. The default is {}.</span>
<span class="sd">        linewidth : float, optional</span>
<span class="sd">            Width of plotted lines. The default is 1.</span>
<span class="sd">        **cpsd_matrices : PowerSpectralDensityArray</span>
<span class="sd">            PSDs to plot.  Only gets plotted if response and reference are</span>
<span class="sd">            identical.  The key will be used as the label with _ replaced by a</span>
<span class="sd">            space.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If degrees of freedom are not consistent between PSDs</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asds</span> <span class="o">=</span> <span class="p">{</span><span class="n">legend</span><span class="p">:</span><span class="n">cpsd</span><span class="o">.</span><span class="n">get_asd</span><span class="p">()</span> <span class="k">for</span> <span class="n">legend</span><span class="p">,</span><span class="n">cpsd</span> <span class="ow">in</span> <span class="n">cpsd_matrices</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">legend</span><span class="p">,</span><span class="n">asd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">asds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">this_dofs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">asd</span><span class="o">.</span><span class="n">coordinate</span><span class="p">)</span>
            <span class="n">this_abscissa</span> <span class="o">=</span> <span class="n">asd</span><span class="o">.</span><span class="n">abscissa</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dofs</span> <span class="o">=</span> <span class="n">this_dofs</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">this_dofs</span> <span class="o">==</span> <span class="n">dofs</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;CPSDs must have identical dofs&#39;</span><span class="p">)</span>
        <span class="c1"># Sort the dofs correctly</span>
        <span class="n">asds</span> <span class="o">=</span> <span class="p">{</span><span class="n">legend</span><span class="p">:</span><span class="n">asd</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">dofs</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span><span class="mi">2</span><span class="p">)]</span> <span class="k">for</span> <span class="n">legend</span><span class="p">,</span><span class="n">asd</span> <span class="ow">in</span> <span class="n">asds</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">num_channels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">this_dofs</span><span class="p">)</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_channels</span><span class="p">)))</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_channels</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>
        <span class="n">total_rows</span> <span class="o">=</span> <span class="n">nrows</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">figure_kwargs</span><span class="p">)</span>
        <span class="n">grid_spec</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">total_rows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_channels</span><span class="p">):</span>
            <span class="n">this_row</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="n">ncols</span>
            <span class="n">this_col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">%</span> <span class="n">ncols</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">this_row</span><span class="p">,</span> <span class="n">this_col</span><span class="p">])</span>
                <span class="n">original_ax</span> <span class="o">=</span> <span class="n">ax</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">this_row</span><span class="p">,</span> <span class="n">this_col</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">original_ax</span><span class="p">,</span>
                                     <span class="n">sharey</span><span class="o">=</span><span class="n">original_ax</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">legend</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">asds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dofs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_row</span> <span class="o">==</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_col</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">prop_cycle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.prop_cycle&#39;</span><span class="p">]</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">prop_cycle</span><span class="o">.</span><span class="n">by_key</span><span class="p">()[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid_spec</span><span class="p">[</span><span class="n">total_rows</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">ncols</span><span class="p">])</span>
        <span class="n">legend_handles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">legend_strings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">legend</span><span class="p">,</span><span class="n">asd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">asds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">fn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">asd</span><span class="p">):</span>
                <span class="n">rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">abscissa</span><span class="p">)))</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">asds</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">j</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">rms</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">legend_handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                    <span class="n">legend_strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39; </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rms</span><span class="p">),</span>
                        <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
        <span class="c1"># Set XTicks</span>
        <span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">asds</span><span class="p">)))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dofs</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">asds</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">xticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dof</span><span class="p">)</span> <span class="k">for</span> <span class="n">dof</span> <span class="ow">in</span> <span class="n">dofs</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xticklabels</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;RMS Levels&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_handles</span><span class="p">,</span><span class="n">legend_strings</span><span class="p">,</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">legend_width</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">width</span>
        <span class="n">figure_width</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span>
        <span class="n">figure_fraction</span> <span class="o">=</span> <span class="n">legend_width</span><span class="o">/</span><span class="n">figure_width</span>
        <span class="n">ax_position</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">ax_position</span><span class="o">.</span><span class="n">x1</span> <span class="o">-=</span> <span class="n">figure_fraction</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">ax_position</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="PowerSpectralDensityArray.coherence"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.coherence">[docs]</a>    <span class="k">def</span> <span class="nf">coherence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the coherence of a PSD matrix</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If abscissa are not consistent.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CoherenceArray</span>
<span class="sd">            CoherenceArray containing the values of coherence for each function.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reshaped_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span>
        <span class="n">abscissa</span> <span class="o">=</span> <span class="n">reshaped_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">reshaped_array</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span><span class="n">abscissa</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;All functions must have identical abscissa&#39;</span><span class="p">)</span>
        <span class="n">cpsd_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">reshaped_array</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">coherence_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">sp_coherence</span><span class="p">(</span><span class="n">cpsd_matrix</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">coherence_array</span> <span class="o">=</span> <span class="n">data_array</span><span class="p">(</span>
            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">COHERENCE</span><span class="p">,</span><span class="n">abscissa</span> <span class="o">=</span> <span class="n">reshaped_array</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span>
            <span class="n">ordinate</span> <span class="o">=</span> <span class="n">coherence_matrix</span><span class="p">,</span> <span class="n">coordinate</span> <span class="o">=</span> <span class="n">reshaped_array</span><span class="o">.</span><span class="n">coordinate</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coherence_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="PowerSpectralDensityArray.angle"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.angle">[docs]</a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the angle of a PSD matrix</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDDataArray</span>
<span class="sd">            Data array consisting of the angle of each function at each</span>
<span class="sd">            frequency line</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">GENERAL</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate</span><span class="p">),</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="PowerSpectralDensityArray.set_coherence_phase"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.set_coherence_phase">[docs]</a>    <span class="k">def</span> <span class="nf">set_coherence_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">coherence_array</span><span class="p">,</span><span class="n">angle_array</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the coherence and phase of a PSD matrix while maintaining the ASDs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coherence_array : CoherenceArray</span>
<span class="sd">            Coherence to which the PSD will be set</span>
<span class="sd">        angle_array : NDDataArray</span>
<span class="sd">            Phase to which the PSD will be set</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output : PowerSpectralDensityArray</span>
<span class="sd">            PSD with coherence and phase matching that of the input argument</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">asds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_asd</span><span class="p">()</span>
        <span class="n">dofs</span> <span class="o">=</span> <span class="n">outer_product</span><span class="p">(</span><span class="n">asds</span><span class="o">.</span><span class="n">response_coordinate</span><span class="p">,</span><span class="n">asds</span><span class="o">.</span><span class="n">reference_coordinate</span><span class="p">)</span>
        <span class="n">reshaped_coherence</span> <span class="o">=</span> <span class="n">coherence_array</span><span class="p">[</span><span class="n">dofs</span><span class="p">]</span>
        <span class="n">reshaped_angle</span> <span class="o">=</span> <span class="n">angle_array</span><span class="p">[</span><span class="n">dofs</span><span class="p">]</span>
        <span class="n">asd_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">asds</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">coherence_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">reshaped_coherence</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">phase_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">reshaped_angle</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cpsd_matrix</span> <span class="o">=</span> <span class="n">cpsd_from_coh_phs</span><span class="p">(</span><span class="n">asd_matrix</span><span class="p">,</span><span class="n">coherence_matrix</span><span class="p">,</span><span class="n">phase_matrix</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span><span class="p">,</span>
                            <span class="n">asds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">cpsd_matrix</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                            <span class="n">dofs</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">coordinate</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">output</span></div>

<div class="viewcode-block" id="PowerSpectralDensityArray.eye"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.eye">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">eye</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span><span class="n">frequencies</span><span class="p">,</span><span class="n">coordinates</span><span class="p">,</span><span class="n">rms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">full_matrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">breakpoint_frequencies</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">breakpoint_levels</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">breakpoint_interpolation</span> <span class="o">=</span> <span class="s1">&#39;lin&#39;</span><span class="p">,</span>
            <span class="n">min_frequency</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_frequency</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a diagonal CPSD matrix</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frequencies : ndarray</span>
<span class="sd">            Frequencies at which the CPSD should be constructed</span>
<span class="sd">        coordinates : CoordinateArray</span>
<span class="sd">            CoordinateArray to use to set the CPSD values</span>
<span class="sd">        rms : ndarray, optional</span>
<span class="sd">            Value to scale the RMS of each CPSD to</span>
<span class="sd">        full_matrix : bool, optional</span>
<span class="sd">            If True, a full, square CPSD matrix will be computed.  If False, only</span>
<span class="sd">            the ASDs will be computed. The default is False.</span>
<span class="sd">        breakpoint_frequencies : iterable, optional</span>
<span class="sd">            A list of frequencies that breakpoints are defined at.</span>
<span class="sd">        breakpoint_levels : iterable, optional</span>
<span class="sd">            A list of levels that breakpoints are defined at</span>
<span class="sd">        breakpoint_interpolation : str, optional</span>
<span class="sd">            &#39;lin&#39; or &#39;log&#39; to specify the type of interpolation. The default is</span>
<span class="sd">            &#39;lin&#39;.</span>
<span class="sd">        min_frequency : float, optional</span>
<span class="sd">            Low frequency cutoff for the CPSD.  Frequency lines below this value</span>
<span class="sd">            will be set to zero.</span>
<span class="sd">        max_frequency : float, optional</span>
<span class="sd">            High frequency cutoff for the CPSD.  Frequency lines above this value</span>
<span class="sd">            will be set to zero.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If invalid interpolation is specified, or if RMS is specified with</span>
<span class="sd">            inconsistent frequency spacing.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PowerSpectralDensityArray</span>
<span class="sd">            A set of PSDs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">breakpoint_frequencies</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">breakpoint_levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cpsd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">frequencies</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">breakpoint_interpolation</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;logarithmic&#39;</span><span class="p">]:</span>
                <span class="n">cpsd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">frequencies</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">breakpoint_frequencies</span><span class="p">),</span>
                                 <span class="n">breakpoint_levels</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">breakpoint_interpolation</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;lin&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">]:</span>
                <span class="n">cpsd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">breakpoint_frequencies</span><span class="p">,</span> <span class="n">breakpoint_levels</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid Interpolation, should be &quot;lin&quot; or &quot;log&quot;&#39;</span><span class="p">)</span>
        
        <span class="c1"># Truncate to the minimum frequency</span>
        <span class="n">cpsd</span><span class="p">[</span><span class="n">frequencies</span> <span class="o">&lt;</span> <span class="n">min_frequency</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">max_frequency</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cpsd</span><span class="p">[</span><span class="n">frequencies</span> <span class="o">&gt;</span> <span class="n">max_frequency</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">rms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frequency_spacing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">frequencies</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">frequency_spacing</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;In order to specify RMS, the spacing of frequencies must be constant&#39;</span><span class="p">)</span>
            <span class="n">cpsd_rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cpsd</span><span class="p">)</span> <span class="o">*</span> <span class="n">frequency_spacing</span><span class="p">)</span>
            <span class="n">cpsd</span> <span class="o">*=</span> <span class="p">(</span><span class="n">rms</span> <span class="o">/</span> <span class="n">cpsd_rms</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            
        <span class="n">num_channels</span> <span class="o">=</span> <span class="n">coordinates</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">full_matrix</span><span class="p">:</span>
            <span class="n">full_cpsd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_channels</span><span class="p">,</span><span class="n">num_channels</span><span class="p">,</span><span class="n">frequencies</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
            <span class="n">full_cpsd</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_channels</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_channels</span><span class="p">),:]</span> <span class="o">=</span> <span class="n">cpsd</span>
            <span class="n">cpsd_coordinates</span> <span class="o">=</span> <span class="n">outer_product</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="n">coordinates</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">full_cpsd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">cpsd</span><span class="p">,(</span><span class="n">num_channels</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">cpsd_coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span><span class="p">,</span><span class="n">frequencies</span><span class="p">,</span>
                          <span class="n">full_cpsd</span><span class="p">,</span><span class="n">cpsd_coordinates</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="PowerSpectralDensityArray.plot_magnitude_coherence_phase"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectralDensityArray.html#sdynpy.core.sdynpy_data.PowerSpectralDensityArray.plot_magnitude_coherence_phase">[docs]</a>    <span class="k">def</span> <span class="nf">plot_magnitude_coherence_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">compare_data</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">plot_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">logx</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">logy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">magnitude_plot_kwargs</span> <span class="o">=</span> <span class="p">{},</span>
                                       <span class="n">coherence_plot_kwargs</span> <span class="o">=</span> <span class="p">{},</span>
                                       <span class="n">angle_plot_kwargs</span> <span class="o">=</span> <span class="p">{},</span>
                                       <span class="n">figure_kwargs</span> <span class="o">=</span> <span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the magnitude, coherence, and phase of a CPSD matrix.</span>
<span class="sd">        </span>
<span class="sd">        Coherence is plotted on the upper triangle, phase on the lower triangle,</span>
<span class="sd">        and magnitude on the diagonal.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        compare_data : PowerSpectralDensityArray, optional</span>
<span class="sd">            An optional dataset to compare against. The default is None.</span>
<span class="sd">        plot_axes : bool, optional</span>
<span class="sd">            If True, axes tick labels will be plotted.  If false, the plots will</span>
<span class="sd">            be pushed right against one another without room for labels.</span>
<span class="sd">            The default is False.</span>
<span class="sd">        sharex : bool, optional</span>
<span class="sd">            If True, all plots will share the same range on the X axis. The</span>
<span class="sd">            default is True.</span>
<span class="sd">        sharey : bool, optional</span>
<span class="sd">            If true, all plots of the same type will share the same range on the</span>
<span class="sd">            Y axis. The default is True.</span>
<span class="sd">        logx : bool, optional</span>
<span class="sd">            If true, the x-axis will be logarithmic. The default is False.</span>
<span class="sd">        logy : bool, optional</span>
<span class="sd">            If true, the y-axis on magnitude plots will be logrithmic. The</span>
<span class="sd">            default is True.</span>
<span class="sd">        magnitude_plot_kwargs : dict, optional</span>
<span class="sd">            Optional keywards to use when plotting magnitude. The default is {}.</span>
<span class="sd">        coherence_plot_kwargs : dict, optional</span>
<span class="sd">            Optional keywards to use when plotting coherence. The default is {}.</span>
<span class="sd">        angle_plot_kwargs : dict, optional</span>
<span class="sd">            Optional keywards to use when plotting phase. The default is {}.</span>
<span class="sd">        figure_kwargs : dict, optional</span>
<span class="sd">            Optional keywards to use when creating the figure. The default is {}.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">figure_kwargs</span><span class="p">)</span>
        <span class="n">reshaped_array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span>
        <span class="n">coherence</span> <span class="o">=</span> <span class="n">reshaped_array</span><span class="o">.</span><span class="n">coherence</span><span class="p">()</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">reshaped_array</span><span class="o">.</span><span class="n">angle</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reshaped_compare_data</span> <span class="o">=</span> <span class="n">compare_data</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span>
            <span class="n">compare_coherence</span> <span class="o">=</span> <span class="n">reshaped_compare_data</span><span class="o">.</span><span class="n">coherence</span><span class="p">()</span>
            <span class="n">phase_compare</span> <span class="o">=</span> <span class="n">reshaped_compare_data</span><span class="o">.</span><span class="n">angle</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="o">*</span><span class="n">reshaped_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">fig</span><span class="p">,</span>
                      <span class="n">wspace</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">plot_axes</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
                      <span class="n">hspace</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">plot_axes</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">function</span> <span class="ow">in</span> <span class="n">reshaped_array</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">((</span><span class="ow">not</span> <span class="n">sharex</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">sharey</span><span class="p">))</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
                <span class="k">elif</span> <span class="p">(</span><span class="ow">not</span> <span class="n">sharex</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sharey</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">sharex</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">sharey</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                                              <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">ordinate</span><span class="p">),</span>
                             <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">magnitude_plot_kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">reshaped_compare_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span>
                                 <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reshaped_compare_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">),</span>
                                 <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">.5</span><span class="p">,</span><span class="mf">.5</span><span class="p">],</span><span class="o">**</span><span class="n">magnitude_plot_kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">logy</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span>
                    <span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span>
                    <span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sharex</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sharey</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span><span class="n">phase</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span>
                              <span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">angle_plot_kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phase_compare</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span>
                                 <span class="n">phase_compare</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span>
                                 <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="o">**</span><span class="n">angle_plot_kwargs</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span>
                    <span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">],</span>
                    <span class="n">sharex</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sharex</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">sharey</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sharey</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span><span class="n">coherence</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span>
                              <span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">coherence_plot_kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">compare_coherence</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span>
                                 <span class="n">compare_coherence</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span>
                                 <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],</span><span class="o">**</span><span class="n">coherence_plot_kwargs</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">logx</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">response_coordinate</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">reshaped_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">reference_coordinate</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">plot_axes</span><span class="p">:</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span></div></div>
    
<div class="viewcode-block" id="PowerSpectrumArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.PowerSpectrumArray.html#sdynpy.core.sdynpy_data.PowerSpectrumArray">[docs]</a><span class="k">class</span> <span class="nc">PowerSpectrumArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store power spectra arrays&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;complex128&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">AUTOSPECTRUM</span></div>
<span class="c1"># def power_spectrum_array(abscissa,ordinate,coordinate,comment1=&#39;&#39;,comment2=&#39;&#39;,comment3=&#39;&#39;,comment4=&#39;&#39;,comment5=&#39;&#39;):</span>
<span class="c1">#     pass</span>


<div class="viewcode-block" id="TransferFunctionArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray">[docs]</a><span class="k">class</span> <span class="nc">TransferFunctionArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store transfer functions (for example FRFs)&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;complex128&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

<div class="viewcode-block" id="TransferFunctionArray.from_time_data"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.from_time_data">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">from_time_data</span><span class="p">(</span><span class="n">reference_data</span><span class="p">:</span> <span class="n">TimeHistoryArray</span><span class="p">,</span>
                       <span class="n">response_data</span><span class="p">:</span> <span class="n">TimeHistoryArray</span><span class="p">,</span>
                       <span class="n">samples_per_average</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                       <span class="n">overlap</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;H1&#39;</span><span class="p">,</span>
                       <span class="n">window</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">1.0</span><span class="p">,)),</span> <span class="o">**</span><span class="n">timedata2frf_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a transfer function from reference and response time histories</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        reference_data : TimeHistoryArray</span>
<span class="sd">            Time data to be used as a reference</span>
<span class="sd">        response_data : TimeHistoryArray</span>
<span class="sd">            Time data to be used as responses</span>
<span class="sd">        samples_per_average : int, optional</span>
<span class="sd">            Number of samples used to split up the signals into averages.  The</span>
<span class="sd">            default is None, meaning the data is treated as a single measurement</span>
<span class="sd">            frame.</span>
<span class="sd">        overlap : float, optional</span>
<span class="sd">            The overlap as a fraction of the frame (e.g. 0.5 specifies 50% overlap).</span>
<span class="sd">            The default is 0.0, meaning no overlap is used.</span>
<span class="sd">        method : str, optional</span>
<span class="sd">            The method for creating the frequency response function. &#39;H1&#39; is </span>
<span class="sd">            default if not specified.</span>
<span class="sd">        window : np.ndarray or str, optional</span>
<span class="sd">            A 1D ndarray with length samples_per_average that specifies the</span>
<span class="sd">            coefficients of the window.  No window is applied if not specified.</span>
<span class="sd">            If a string is specified, then the window will be obtained from scipy.</span>
<span class="sd">        **timedata2frf_kwargs : various</span>
<span class="sd">            Additional keyword arguments that may be passed into the</span>
<span class="sd">            timedata2frf function in sdynpy.frf.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if reference and response functions do not have consistent</span>
<span class="sd">            abscissa</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TransferFunctionArray</span>
<span class="sd">            A transfer function array computed from the specified references and</span>
<span class="sd">            responses.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ref_data</span> <span class="o">=</span> <span class="n">reference_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">res_data</span> <span class="o">=</span> <span class="n">response_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">ref_ord</span> <span class="o">=</span> <span class="n">ref_data</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="n">res_ord</span> <span class="o">=</span> <span class="n">res_data</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ref_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span>
                           <span class="n">res_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Reference and Response Data should have identical abscissa spacing!&#39;</span><span class="p">)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ref_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span><span class="p">))</span>
        <span class="n">freq</span><span class="p">,</span> <span class="n">frf</span> <span class="o">=</span> <span class="n">timedata2frf</span><span class="p">(</span><span class="n">ref_ord</span><span class="p">,</span> <span class="n">res_ord</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">samples_per_average</span><span class="p">,</span> <span class="n">overlap</span><span class="p">,</span>
                                 <span class="n">method</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="o">**</span><span class="n">timedata2frf_kwargs</span><span class="p">)</span>
        <span class="c1"># Now construct the transfer function array</span>
        <span class="n">coordinate</span> <span class="o">=</span> <span class="n">outer_product</span><span class="p">(</span><span class="n">res_data</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                   <span class="n">ref_data</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">data_array</span><span class="p">(</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">FREQUENCY_RESPONSE_FUNCTION</span><span class="p">,</span>
                          <span class="n">freq</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">frf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">coordinate</span><span class="p">)</span></div>

<div class="viewcode-block" id="TransferFunctionArray.compute_mif"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.compute_mif">[docs]</a>    <span class="k">def</span> <span class="nf">compute_mif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mif_type</span><span class="p">,</span> <span class="o">*</span><span class="n">mif_args</span><span class="p">,</span> <span class="o">**</span><span class="n">mif_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute a mode indicator functions from the transfer functions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mif_type : str</span>
<span class="sd">            Mode indicator function type, one of &#39;cmif&#39;,&#39;nmif&#39;, or &#39;mmif&#39;</span>
<span class="sd">        *mif_args : list</span>
<span class="sd">            Arguments passed to the compute_*mif function</span>
<span class="sd">        **mif_kwargs : dict</span>
<span class="sd">            Keyword arguments passed to the compute_*mif function</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If an invalid mif name is provided.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ModeIndicatorFunctionArray</span>
<span class="sd">            Mode indicator function</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mif_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;cmif&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_cmif</span><span class="p">(</span><span class="o">*</span><span class="n">mif_args</span><span class="p">,</span> <span class="o">**</span><span class="n">mif_kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mif_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;mmif&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_mmif</span><span class="p">(</span><span class="o">*</span><span class="n">mif_args</span><span class="p">,</span> <span class="o">**</span><span class="n">mif_kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mif_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;nmif&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_nmif</span><span class="p">(</span><span class="o">*</span><span class="n">mif_args</span><span class="p">,</span> <span class="o">**</span><span class="n">mif_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid MIF type, must be one of cmif, mmif, or nmif&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TransferFunctionArray.compute_cmif"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.compute_cmif">[docs]</a>    <span class="k">def</span> <span class="nf">compute_cmif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">tracking</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a complex mode indicator function from the</span>
<span class="sd">        TransferFunctionArray</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        part : str, optional</span>
<span class="sd">            Specifies which part(s) of the transfer functions are used to</span>
<span class="sd">            compute the CMIF.  Can be &#39;real&#39;, &#39;imag&#39;, or &#39;both&#39;.  The default</span>
<span class="sd">            is &#39;both&#39;.</span>
<span class="sd">        tracking : str or None, optional</span>
<span class="sd">            Specifies if any singular value tracking should be used.  Can be</span>
<span class="sd">            &#39;left&#39; or &#39;right&#39;. The default is None.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if an invalid tracking is specified</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output_array : ModeIndicatorFunctionArray</span>
<span class="sd">            Complex Mode Indicator Function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matrix_form</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span>
        <span class="n">ordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">matrix_form</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;imag&#39;</span> <span class="ow">or</span> <span class="n">part</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;imaginary&#39;</span><span class="p">:</span>
            <span class="n">ordinate</span> <span class="o">=</span> <span class="n">ordinate</span><span class="o">.</span><span class="n">imag</span>
        <span class="k">if</span> <span class="n">part</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;real&#39;</span><span class="p">:</span>
            <span class="n">ordinate</span> <span class="o">=</span> <span class="n">ordinate</span><span class="o">.</span><span class="n">real</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">ordinate</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">vh</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tracking</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">u_unshuffled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">s_unshuffled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">v_unshuffled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tracking</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                <span class="n">u_unshuffled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">s_unshuffled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">v_unshuffled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">previous_u</span> <span class="o">=</span> <span class="n">u_unshuffled</span><span class="p">[</span><span class="n">line</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">this_u</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">line</span><span class="p">]</span>
                    <span class="c1"># np.linalg.norm(previous_u-this_u,axis=0)</span>
                    <span class="n">comparison_matrix</span> <span class="o">=</span> <span class="n">mac</span><span class="p">(</span><span class="n">previous_u</span><span class="p">,</span> <span class="n">this_u</span><span class="p">)</span>
                    <span class="n">current_sorting</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">comparison_matrix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">u_unshuffled</span><span class="p">[</span><span class="n">line</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">line</span><span class="p">][:,</span> <span class="n">current_sorting</span><span class="p">]</span>
                    <span class="n">s_unshuffled</span><span class="p">[</span><span class="n">line</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">line</span><span class="p">][</span><span class="n">current_sorting</span><span class="p">]</span>
                    <span class="n">v_unshuffled</span><span class="p">[</span><span class="n">line</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">line</span><span class="p">][:,</span> <span class="n">current_sorting</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">tracking</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="s1">&#39;Tracking by right singular vector is not yet implemented&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;tracking must be None or &quot;left&quot; or &quot;right&quot;&#39;</span><span class="p">)</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">u_unshuffled</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">v_unshuffled</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s_unshuffled</span>
        <span class="n">output_array</span> <span class="o">=</span> <span class="n">ModeIndicatorFunctionArray</span><span class="p">((</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],),</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">response_coordinate</span> <span class="o">=</span> <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">T</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">[(</span>
            <span class="mi">0</span><span class="p">,)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),)]</span>
        <span class="k">return</span> <span class="n">output_array</span></div>

<div class="viewcode-block" id="TransferFunctionArray.compute_nmif"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.compute_nmif">[docs]</a>    <span class="k">def</span> <span class="nf">compute_nmif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a normal mode indicator function from the</span>
<span class="sd">        TransferFunctionArray</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        part : str, optional</span>
<span class="sd">            Specifies which part(s) of the transfer functions are used to</span>
<span class="sd">            compute the NMIF.  Can be &#39;real&#39; or &#39;imag&#39;.  The default</span>
<span class="sd">            is &#39;real&#39;.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if an invalid part is specified</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output_array : ModeIndicatorFunctionArray</span>
<span class="sd">            Normal Mode Indicator Function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span>
        <span class="k">if</span> <span class="n">part</span> <span class="o">==</span> <span class="s1">&#39;real&#39;</span><span class="p">:</span>
            <span class="n">nmif</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ordinate</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ordinate</span><span class="p">)),</span>
                          <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ordinate</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">part</span> <span class="o">==</span> <span class="s1">&#39;imag&#39;</span><span class="p">:</span>
            <span class="n">nmif</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ordinate</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">ordinate</span><span class="p">)),</span>
                          <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ordinate</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;part must be &quot;real&quot; or &quot;imag&quot;&#39;</span><span class="p">)</span>
        <span class="n">output_array</span> <span class="o">=</span> <span class="n">ModeIndicatorFunctionArray</span><span class="p">((),</span> <span class="n">nmif</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">[(</span>
            <span class="mi">0</span><span class="p">,)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),)]</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">nmif</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">response_coordinate</span> <span class="o">=</span> <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_array</span></div>

<div class="viewcode-block" id="TransferFunctionArray.compute_mmif"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.compute_mmif">[docs]</a>    <span class="k">def</span> <span class="nf">compute_mmif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">part</span><span class="o">=</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="n">mass_matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes a Multi Mode indicator function from the</span>
<span class="sd">        TransferFunctionArray</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        part : str, optional</span>
<span class="sd">            Specifies which part(s) of the transfer functions are used to</span>
<span class="sd">            compute the NMIF.  Can be &#39;real&#39; or &#39;imag&#39;.  The default</span>
<span class="sd">            is &#39;real&#39;.</span>
<span class="sd">        mass_matrix : np.ndarray, optional</span>
<span class="sd">            Matrix used to compute the MMIF, Identity is used if not specified</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            Raised if an invalid part is specified</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output_array : ModeIndicatorFunctionArray</span>
<span class="sd">            Multi Mode Indicator Function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rect_frf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span>
        <span class="n">ordinate</span> <span class="o">=</span> <span class="n">rect_frf</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ordinate</span><span class="p">)</span>
        <span class="n">imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">ordinate</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mass_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mass_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">real</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">mass_matrix</span> <span class="o">@</span> <span class="n">real</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">imag</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">@</span> <span class="n">mass_matrix</span> <span class="o">@</span> <span class="n">imag</span>
        <span class="n">mif_ordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">part</span> <span class="o">==</span> <span class="s1">&#39;real&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">this_a</span><span class="p">,</span> <span class="n">this_b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)):</span>
                <span class="n">evalue</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">this_a</span><span class="p">,</span> <span class="p">(</span><span class="n">this_a</span> <span class="o">+</span> <span class="n">this_b</span><span class="p">),</span> <span class="n">eigvals_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">mif_ordinate</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">evalue</span>
        <span class="k">elif</span> <span class="n">part</span> <span class="o">==</span> <span class="s1">&#39;imag&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">this_a</span><span class="p">,</span> <span class="n">this_b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)):</span>
                <span class="n">evalue</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">this_b</span><span class="p">,</span> <span class="p">(</span><span class="n">this_a</span> <span class="o">+</span> <span class="n">this_b</span><span class="p">),</span> <span class="n">eigenvals_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">mif_ordinate</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">evalue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;part must be &quot;real&quot; or &quot;imag&quot;&#39;</span><span class="p">)</span>
        <span class="n">output_array</span> <span class="o">=</span> <span class="n">ModeIndicatorFunctionArray</span><span class="p">(</span><span class="n">mif_ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">mif_ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">[(</span>
            <span class="mi">0</span><span class="p">,)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),)]</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">mif_ordinate</span><span class="o">.</span><span class="n">T</span>
        <span class="n">output_array</span><span class="o">.</span><span class="n">response_coordinate</span> <span class="o">=</span> <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mif_ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_array</span></div>

<div class="viewcode-block" id="TransferFunctionArray.plot"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">one_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subplots_kwargs</span><span class="o">=</span><span class="p">{},</span> <span class="n">plot_kwargs</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the transfer functions</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        one_axis : bool, optional</span>
<span class="sd">            Set to True to plot all data on one axis.  Set to False to plot</span>
<span class="sd">            data on multiple subplots.  one_axis can also be set to a </span>
<span class="sd">            matplotlib axis to plot data on an existing axis.  The default is</span>
<span class="sd">            True.</span>
<span class="sd">        subplots_kwargs : dict, optional</span>
<span class="sd">            Keywords passed to the matplotlib subplots function to create the</span>
<span class="sd">            figure and axes. The default is {}.</span>
<span class="sd">        plot_kwargs : dict, optional</span>
<span class="sd">            Keywords passed to the matplotlib plot function. The default is {}.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        axis : matplotlib axis or array of axes</span>
<span class="sd">             On which the data were plotted</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">one_axis</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">subplots_kwargs</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase&#39;</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">one_axis</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>
            <span class="n">figure</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="o">**</span><span class="n">subplots_kwargs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">function</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">())):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">function</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">()]))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axis</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">one_axis</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
            <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">abscissa</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axis</span></div>

<div class="viewcode-block" id="TransferFunctionArray.delay_response"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.delay_response">[docs]</a>    <span class="k">def</span> <span class="nf">delay_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjusts the FRF phases as if the response had been shifted `dt` in time</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dt : float</span>
<span class="sd">            Time shift to apply to the responses</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        shifted_transfer_function : TransferFunctionArray</span>
<span class="sd">            A copy of the transfer function with the phase shifted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shifted_transfer_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">omegas</span> <span class="o">=</span> <span class="n">shifted_transfer_function</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">shifted_transfer_function</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omegas</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">shifted_transfer_function</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">FREQUENCY_RESPONSE_FUNCTION</span>

<div class="viewcode-block" id="TransferFunctionArray.substructure_by_constraint_matrix"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.substructure_by_constraint_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">substructure_by_constraint_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dofs</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs frequency based substructuring using the </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dofs : CoordinateArray</span>
<span class="sd">            Coordinates to use in the constraints</span>
<span class="sd">        constraint_matrix : np.ndarray</span>
<span class="sd">            Constraints to apply to the frequency response functions</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If listed degrees of freedom are not found in the function.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        constrained_frfs : TransferFunctionArray</span>
<span class="sd">            Constrained Frequency Response Functions</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create a rectangular FRF array</span>
        <span class="n">rect_frfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Extract the reference and response dofs</span>
        <span class="n">response_dofs</span> <span class="o">=</span> <span class="n">rect_frfs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">response_coordinate</span>
        <span class="n">reference_dofs</span> <span class="o">=</span> <span class="n">rect_frfs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reference_coordinate</span>
        <span class="c1"># Now find the indices of each of the dofs</span>
        <span class="n">reference_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">reference_dofs</span><span class="p">),</span>
                                            <span class="nb">abs</span><span class="p">(</span><span class="n">dofs</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">reference_dofs</span><span class="p">[</span><span class="n">reference_indices</span><span class="p">])</span> <span class="o">!=</span>
                  <span class="nb">abs</span><span class="p">(</span><span class="n">dofs</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Not all constraint degrees of freedom are found in the references&#39;</span><span class="p">)</span>
        <span class="n">response_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">response_dofs</span><span class="p">),</span>
                                           <span class="nb">abs</span><span class="p">(</span><span class="n">dofs</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">response_dofs</span><span class="p">[</span><span class="n">response_indices</span><span class="p">])</span> <span class="o">!=</span>
                  <span class="nb">abs</span><span class="p">(</span><span class="n">dofs</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Not all constraint degrees of freedom are found in the responses&#39;</span><span class="p">)</span>
        <span class="c1"># Handle sign flipping</span>
        <span class="n">flip_sign_references</span> <span class="o">=</span> <span class="n">reference_dofs</span><span class="p">[</span><span class="n">reference_indices</span><span class="p">]</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span> <span class="o">*</span> <span class="n">dofs</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
        <span class="n">flip_sign_responses</span> <span class="o">=</span> <span class="n">response_dofs</span><span class="p">[</span><span class="n">response_indices</span><span class="p">]</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span> <span class="o">*</span> <span class="n">dofs</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
        <span class="c1"># Put together the constraint matrix</span>
        <span class="n">constraint_matrix_responses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">constraint_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">response_dofs</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">constraint_matrix_references</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">constraint_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reference_dofs</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">constraint_matrix_responses</span><span class="p">[:,</span> <span class="n">response_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">flip_sign_responses</span> <span class="o">*</span> <span class="n">constraint_matrix</span>
        <span class="n">constraint_matrix_references</span><span class="p">[:,</span>
                                     <span class="n">reference_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">flip_sign_references</span> <span class="o">*</span> <span class="n">constraint_matrix</span>
        <span class="c1"># Perform the constraint</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">rect_frfs</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">H_constrained</span> <span class="o">=</span> <span class="n">H</span> <span class="o">-</span> <span class="n">H</span> <span class="o">@</span> <span class="n">constraint_matrix_references</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span>
            <span class="n">constraint_matrix_responses</span> <span class="o">@</span> <span class="n">H</span> <span class="o">@</span> <span class="n">constraint_matrix_references</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">constraint_matrix_responses</span> <span class="o">@</span> <span class="n">H</span><span class="p">)</span>
        <span class="n">rect_frfs</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">H_constrained</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rect_frfs</span></div>

<div class="viewcode-block" id="TransferFunctionArray.substructure_by_coordinate"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransferFunctionArray.html#sdynpy.core.sdynpy_data.TransferFunctionArray.substructure_by_coordinate">[docs]</a>    <span class="k">def</span> <span class="nf">substructure_by_coordinate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dof_pairs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs frequency based substructuring by constraining pairs of degrees</span>
<span class="sd">        of freedom</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dof_pairs : CoordinateArray or None</span>
<span class="sd">            Pairs of coordinates to constrain together.  To constain a coordinate</span>
<span class="sd">            to ground (i.e. fix it so it cannot move), the coordinate should be</span>
<span class="sd">            paired with None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        TransferFunctionArray</span>
<span class="sd">            Constrained frequency response functions</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dof_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">constraint_matrix_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">constraint_index</span><span class="p">,</span> <span class="n">dof_pair</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dof_pairs</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">sign</span><span class="p">,</span> <span class="n">dof</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dof_pair</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">dof</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="n">dof_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">dof</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">dof_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">dof</span><span class="p">))</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dof_list</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">flip_sign</span> <span class="o">=</span> <span class="n">dof</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
                <span class="n">constraint_matrix_values</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">constraint_index</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span>
                                                 <span class="n">flip_sign</span> <span class="o">*</span> <span class="n">sign</span><span class="p">))</span>
        <span class="c1"># Now create the final matrix and fill it</span>
        <span class="n">constraint_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">dof_pairs</span><span class="p">),</span>
                                      <span class="nb">len</span><span class="p">(</span><span class="n">dof_list</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">constraint_matrix_values</span><span class="p">:</span>
            <span class="n">constraint_matrix</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="c1"># Apply Constraints</span>
        <span class="n">dof_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dof_list</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">CoordinateArray</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substructure_by_constraint_matrix</span><span class="p">(</span><span class="n">dof_list</span><span class="p">,</span> <span class="n">constraint_matrix</span><span class="p">)</span></div></div>

<span class="c1"># def transfer_function_array(abscissa,ordinate,coordinate,comment1=&#39;&#39;,comment2=&#39;&#39;,comment3=&#39;&#39;,comment4=&#39;&#39;,comment5=&#39;&#39;):</span>
<span class="c1">#     pass</span>


<div class="viewcode-block" id="TransmissibilityArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.TransmissibilityArray.html#sdynpy.core.sdynpy_data.TransmissibilityArray">[docs]</a><span class="k">class</span> <span class="nc">TransmissibilityArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store transmissibility data&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;complex128&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TRANSMISIBILITY</span></div>
<span class="c1"># def transmisibility_array(abscissa,ordinate,coordinate,comment1=&#39;&#39;,comment2=&#39;&#39;,comment3=&#39;&#39;,comment4=&#39;&#39;,comment5=&#39;&#39;):</span>
<span class="c1">#     pass</span>


<div class="viewcode-block" id="CoherenceArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CoherenceArray.html#sdynpy.core.sdynpy_data.CoherenceArray">[docs]</a><span class="k">class</span> <span class="nc">CoherenceArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store coherence data&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">COHERENCE</span></div>


<div class="viewcode-block" id="MultipleCoherenceArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.MultipleCoherenceArray.html#sdynpy.core.sdynpy_data.MultipleCoherenceArray">[docs]</a><span class="k">class</span> <span class="nc">MultipleCoherenceArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store coherence data&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MULTIPLE_COHERENCE</span></div>

<span class="c1"># def coherence_array(abscissa,ordinate,coordinate,comment1=&#39;&#39;,comment2=&#39;&#39;,comment3=&#39;&#39;,comment4=&#39;&#39;,comment5=&#39;&#39;):</span>
<span class="c1">#     pass</span>


<div class="viewcode-block" id="CorrelationArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CorrelationArray.html#sdynpy.core.sdynpy_data.CorrelationArray">[docs]</a><span class="k">class</span> <span class="nc">CorrelationArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data array used to store correlation data&quot;&quot;&quot;</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">CROSSCORRELATION</span></div>

<span class="c1"># def correlation_array(abscissa,ordinate,coordinate,comment1=&#39;&#39;,comment2=&#39;&#39;,comment3=&#39;&#39;,comment4=&#39;&#39;,comment5=&#39;&#39;):</span>
<span class="c1">#     pass</span>


<div class="viewcode-block" id="ModeIndicatorFunctionArray"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.ModeIndicatorFunctionArray.html#sdynpy.core.sdynpy_data.ModeIndicatorFunctionArray">[docs]</a><span class="k">class</span> <span class="nc">ModeIndicatorFunctionArray</span><span class="p">(</span><span class="n">NDDataArray</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mode indicator function (CMIF, NMIF, or NMIF)&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">subtype</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">nelements</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">function_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the function type of the data array</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MODE_INDICATOR_FUNCTION</span></div>

<span class="c1"># def mode_indicator_function_array(abscissa,ordinate,coordinate,comment1=&#39;&#39;,comment2=&#39;&#39;,comment3=&#39;&#39;,comment4=&#39;&#39;,comment5=&#39;&#39;):</span>
<span class="c1">#     pass</span>


<span class="n">_function_type_class_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">GENERAL</span><span class="p">:</span> <span class="n">NDDataArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TIME_RESPONSE</span><span class="p">:</span> <span class="n">TimeHistoryArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">AUTOSPECTRUM</span><span class="p">:</span> <span class="n">PowerSpectrumArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">CROSSSPECTRUM</span><span class="p">:</span> <span class="n">PowerSpectrumArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">FREQUENCY_RESPONSE_FUNCTION</span><span class="p">:</span> <span class="n">TransferFunctionArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TRANSMISIBILITY</span><span class="p">:</span> <span class="n">TransmissibilityArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">COHERENCE</span><span class="p">:</span> <span class="n">CoherenceArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">AUTOCORRELATION</span><span class="p">:</span> <span class="n">CorrelationArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">CROSSCORRELATION</span><span class="p">:</span> <span class="n">CorrelationArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span><span class="p">:</span> <span class="n">PowerSpectralDensityArray</span><span class="p">,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">ENERGY_SPECTRAL_DENSITY</span><span class="p">:</span> <span class="n">PowerSpectralDensityArray</span><span class="p">,</span>
                            <span class="c1"># FunctionTypes.PROBABILITY_DENSITY_FUNCTION, : ,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">:</span> <span class="n">SpectrumArray</span><span class="p">,</span>
                            <span class="c1"># FunctionTypes.CUMULATIVE_FREQUENCY_DISTRIBUTION, : ,</span>
                            <span class="c1"># FunctionTypes.PEAKS_VALLEY, : ,</span>
                            <span class="c1"># FunctionTypes.STRESS_PER_CYCLE, : ,</span>
                            <span class="c1"># FunctionTypes.STRAIN_PER_CYCLE, : ,</span>
                            <span class="c1"># FunctionTypes.ORBIT, : ,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MODE_INDICATOR_FUNCTION</span><span class="p">:</span> <span class="n">ModeIndicatorFunctionArray</span><span class="p">,</span>
                            <span class="c1"># FunctionTypes.FORCE_PATTERN, : ,</span>
                            <span class="c1"># FunctionTypes.PARTIAL_POWER, : ,</span>
                            <span class="c1"># FunctionTypes.PARTIAL_COHERENCE, : ,</span>
                            <span class="c1"># FunctionTypes.EIGENVALUE, : ,</span>
                            <span class="c1"># FunctionTypes.EIGENVECTOR, : ,</span>
                            <span class="c1"># FunctionTypes.SHOCK_RESPONSE_SPECTRUM, : ,</span>
                            <span class="c1"># FunctionTypes.FINITE_IMPULSE_RESPONSE_FILTER, : ,</span>
                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MULTIPLE_COHERENCE</span><span class="p">:</span> <span class="n">MultipleCoherenceArray</span><span class="p">,</span>
                            <span class="c1"># FunctionTypes.ORDER_FUNCTION, : ,</span>
                            <span class="c1"># FunctionTypes.PHASE_COMPENSATION,  : ,</span>
                            <span class="p">}</span>


<div class="viewcode-block" id="data_array"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.data_array.html#sdynpy.core.sdynpy_data.data_array">[docs]</a><span class="k">def</span> <span class="nf">data_array</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">abscissa</span><span class="p">,</span> <span class="n">ordinate</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">,</span> <span class="n">comment1</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">comment2</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">comment3</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">comment4</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">comment5</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to create a data array object.</span>

<span class="sd">    All input arguments to this function are allowed to broadcast to create the</span>
<span class="sd">    final data in the NDDataArray object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_type : FunctionTypes</span>
<span class="sd">        Type of data array that will be created</span>
<span class="sd">    abscissa : np.ndarray</span>
<span class="sd">        Numpy array specifying the abscissa of the function</span>
<span class="sd">    ordinate : np.ndarray</span>
<span class="sd">        Numpy array specifying the ordinate of the function</span>
<span class="sd">    coordinate : CoordinateArray</span>
<span class="sd">        Coordinate for each data in the data array</span>
<span class="sd">    comment1 : np.ndarray, optional</span>
<span class="sd">        Comment used to describe the data in the data array. The default is &#39;&#39;.</span>
<span class="sd">    comment2 : np.ndarray, optional</span>
<span class="sd">        Comment used to describe the data in the data array. The default is &#39;&#39;.</span>
<span class="sd">    comment3 : np.ndarray, optional</span>
<span class="sd">        Comment used to describe the data in the data array. The default is &#39;&#39;.</span>
<span class="sd">    comment4 : np.ndarray, optional</span>
<span class="sd">        Comment used to describe the data in the data array. The default is &#39;&#39;.</span>
<span class="sd">    comment5 : np.ndarray, optional</span>
<span class="sd">        Comment used to describe the data in the data array. The default is &#39;&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    obj : NDDataArray or subclass</span>
<span class="sd">        The constructed NDDataArray (or subclass) object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">cls</span> <span class="o">=</span> <span class="n">_function_type_class_map</span><span class="p">[</span><span class="n">data_type</span><span class="p">]</span>
    <span class="n">nelem</span> <span class="o">=</span> <span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="ow">is</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">GENERAL</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="n">nelem</span><span class="p">,</span><span class="n">coordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">nelem</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">ordinate</span> <span class="o">=</span> <span class="n">ordinate</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">=</span> <span class="n">abscissa</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">comment1</span> <span class="o">=</span> <span class="n">comment1</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">comment2</span> <span class="o">=</span> <span class="n">comment2</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">comment3</span> <span class="o">=</span> <span class="n">comment3</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">comment4</span> <span class="o">=</span> <span class="n">comment4</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">comment5</span> <span class="o">=</span> <span class="n">comment5</span>
    <span class="n">num_coords</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;coordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">coordinate</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">coordinate</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">coordinate</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">coordinate</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="n">num_coords</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">obj</span></div>


<span class="n">from_unv</span> <span class="o">=</span> <span class="n">NDDataArray</span><span class="o">.</span><span class="n">from_unv</span>
<span class="n">from_uff</span> <span class="o">=</span> <span class="n">from_unv</span>
<span class="n">load</span> <span class="o">=</span> <span class="n">NDDataArray</span><span class="o">.</span><span class="n">load</span>

<div class="viewcode-block" id="from_imat_struct"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.from_imat_struct.html#sdynpy.core.sdynpy_data.from_imat_struct">[docs]</a><span class="k">def</span> <span class="nf">from_imat_struct</span><span class="p">(</span><span class="n">imat_fn_struct</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Constructs a NDDataArray from an imat_fn class saved to a Matlab structure</span>

<span class="sd">    In IMAT, a structure can be created from an `imat_fn` by using the get()</span>
<span class="sd">    function.  This can then be saved to a .mat file and loaded using</span>
<span class="sd">    `scipy.io.loadmat`.  The output from loadmat can be passed into this function</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    imat_fn_struct : np.ndarray</span>
<span class="sd">        structure from loadmat containing data from an imat_fn</span>
<span class="sd">    squeeze : bool, optional</span>
<span class="sd">        If True, return a single NDDataArray object or subclass if only one</span>
<span class="sd">        function type exists in the data.  Otherwise, it will return a list of</span>
<span class="sd">        length one.  If more than one function type exists, a list of</span>
<span class="sd">        NDDataArray objects will be returned regardless of the value of</span>
<span class="sd">        `squeeze`.  Default is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    return_functions : NDDataArray or list of NDDataArray</span>
<span class="sd">        Returns a list of NDDataArray objects if `squeeze` is false, or a single</span>
<span class="sd">        NDDataArray object if `squeeze` is True, unless there are multiple</span>
<span class="sd">        function types stored in the structure.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get function types</span>
    <span class="n">fn_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;FunctionType&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="n">fn_types</span> <span class="o">=</span> <span class="n">fn_types</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">fn_types</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Separate into the different types of functions</span>
    <span class="n">function_type_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fn_type</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fn_types</span><span class="o">.</span><span class="n">flatten</span><span class="p">()):</span>
        <span class="n">fn_type_enum</span> <span class="o">=</span> <span class="n">_imat_function_type_map</span><span class="p">[</span><span class="n">fn_type</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fn_type_enum</span> <span class="ow">in</span> <span class="n">function_type_dict</span><span class="p">:</span>
            <span class="n">function_type_dict</span><span class="p">[</span><span class="n">fn_type_enum</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">function_type_dict</span><span class="p">[</span><span class="n">fn_type_enum</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">return_functions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">abscissa</span> <span class="o">=</span> <span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;Abscissa&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">abscissa</span> <span class="o">=</span> <span class="n">abscissa</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">abscissa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ordinate</span> <span class="o">=</span> <span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;Ordinate&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">ordinate</span> <span class="o">=</span> <span class="n">ordinate</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">reference_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;ReferenceCoord&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">reference_coords</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">reference_coords</span> <span class="o">=</span> <span class="n">reference_coords</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">reference_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">reference_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">response_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;ResponseCoord&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">response_coords</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">response_coords</span> <span class="o">=</span> <span class="n">response_coords</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">response_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">response_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">response_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">comment_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;IDLine1&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">comment_1</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">comment_1</span> <span class="o">=</span> <span class="n">comment_1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">comment_1</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">comment_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">comment_1</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">comment_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;IDLine2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">comment_2</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">comment_2</span> <span class="o">=</span> <span class="n">comment_1</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">comment_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">comment_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">comment_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">comment_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;IDLine3&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">comment_3</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">comment_3</span> <span class="o">=</span> <span class="n">comment_3</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">comment_3</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">comment_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">comment_3</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">comment_4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">imat_fn_struct</span><span class="p">[</span><span class="s1">&#39;IDLine4&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">comment_4</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">comment_4</span> <span class="o">=</span> <span class="n">comment_4</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">comment_4</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">comment_4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">comment_4</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">comment_5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">comment_4</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U1&#39;</span><span class="p">)</span>
    <span class="n">all_coords</span> <span class="o">=</span> <span class="n">sdynpy_coordinate</span><span class="o">.</span><span class="n">coordinate_array</span><span class="p">(</span><span class="n">string_array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="p">(</span><span class="n">response_coords</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">reference_coords</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">fn_type</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">function_type_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">return_functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">data_array</span><span class="p">(</span><span class="n">fn_type</span><span class="p">,</span> <span class="n">abscissa</span><span class="p">[:,</span> <span class="n">indices</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">ordinate</span><span class="p">[:,</span> <span class="n">indices</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                       <span class="n">all_coords</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span> <span class="n">comment_1</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span> <span class="n">comment_2</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span>
                       <span class="n">comment_3</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span> <span class="n">comment_4</span><span class="p">[</span><span class="n">indices</span><span class="p">],</span> <span class="n">comment_5</span><span class="p">[</span><span class="n">indices</span><span class="p">])</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_functions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">squeeze</span><span class="p">:</span>
        <span class="n">return_functions</span> <span class="o">=</span> <span class="n">return_functions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">return_functions</span></div>

<div class="viewcode-block" id="ComplexType"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.ComplexType.html#sdynpy.core.sdynpy_data.ComplexType">[docs]</a><span class="k">class</span> <span class="nc">ComplexType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Enumeration containing the various ways to plot complex data&quot;&quot;&quot;</span>
    <span class="n">REAL</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">IMAGINARY</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">MAGNITUDE</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">PHASE</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">REALIMAG</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">MAGPHASE</span> <span class="o">=</span> <span class="mi">5</span></div>

<div class="viewcode-block" id="GUIPlot"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot">[docs]</a><span class="k">class</span> <span class="nc">GUIPlot</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;An iteractive plot window allowing users to visualize data&quot;&quot;&quot;</span>

<div class="viewcode-block" id="GUIPlot.__init__"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_array</span><span class="p">:</span> <span class="n">NDDataArray</span><span class="p">,</span> <span class="n">compare_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a GUIPlot window to visualize data.</span>

<span class="sd">        Two datasets can be overlaid by providing a second identically sized</span>
<span class="sd">        dataset as the `compare_data` argument.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data_array : NDDataArray</span>
<span class="sd">            Data to visualize</span>
<span class="sd">        compare_data : NDDataArray, optional</span>
<span class="sd">            Data to compare.  Default is None, which results in no comparison</span>
<span class="sd">            data plotted.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GUIPlot</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="n">uic</span><span class="o">.</span><span class="n">loadUi</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))),</span> <span class="s1">&#39;GUIPlot.ui&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">data_array</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">():</span>
            <span class="n">this_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">insertRow</span><span class="p">(</span><span class="n">this_row</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">response_coordinate</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">response_coordinate</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fn</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;coordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">reference_coordinate</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">reference_coordinate</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">_imat_function_type_inverse_map</span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="n">function_type</span><span class="p">]))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">_imat_function_type_inverse_map</span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="n">function_type</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>
        <span class="c1"># Adjust the default plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_original_shape</span> <span class="o">=</span> <span class="n">data_array</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Dark2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cm_mod</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_data</span> <span class="o">=</span> <span class="n">compare_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Paired</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cm_mod</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">function_type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">GENERAL</span><span class="p">,</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TIME_RESPONSE</span><span class="p">,</span>
                                          <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">COHERENCE</span><span class="p">,</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">AUTOCORRELATION</span><span class="p">,</span>
                                          <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">CROSSCORRELATION</span><span class="p">,</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MODE_INDICATOR_FUNCTION</span><span class="p">,</span>
                                          <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">MULTIPLE_COHERENCE</span><span class="p">]:</span>
            <span class="n">complex_type</span> <span class="o">=</span> <span class="n">ComplexType</span><span class="o">.</span><span class="n">REAL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abscissa_log</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ordinate_log</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">function_type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">AUTOSPECTRUM</span><span class="p">,</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">POWER_SPECTRAL_DENSITY</span><span class="p">,</span>
                                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">SHOCK_RESPONSE_SPECTRUM</span><span class="p">,</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">ENERGY_SPECTRAL_DENSITY</span><span class="p">]:</span>
            <span class="n">complex_type</span> <span class="o">=</span> <span class="n">ComplexType</span><span class="o">.</span><span class="n">MAGNITUDE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abscissa_log</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ordinate_log</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">function_type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">FunctionTypes</span><span class="o">.</span><span class="n">CROSSSPECTRUM</span><span class="p">,</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">FREQUENCY_RESPONSE_FUNCTION</span><span class="p">,</span>
                                            <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">TRANSMISIBILITY</span><span class="p">,</span> <span class="n">FunctionTypes</span><span class="o">.</span><span class="n">SPECTRUM</span><span class="p">]:</span>
            <span class="n">complex_type</span> <span class="o">=</span> <span class="n">ComplexType</span><span class="o">.</span><span class="n">MAGPHASE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abscissa_log</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ordinate_log</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># print(&#39;Unknown Function Type {:}&#39;.format(self.data[0].function_type))</span>
            <span class="n">complex_type</span> <span class="o">=</span> <span class="n">ComplexType</span><span class="o">.</span><span class="n">REAL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abscissa_log</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ordinate_log</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complex_types</span> <span class="o">=</span> <span class="p">{</span><span class="n">ComplexType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionImaginary</span><span class="p">,</span>
                              <span class="n">ComplexType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionMagnitude</span><span class="p">,</span>
                              <span class="n">ComplexType</span><span class="o">.</span><span class="n">MAGPHASE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionMagnitude_Phase</span><span class="p">,</span>
                              <span class="n">ComplexType</span><span class="o">.</span><span class="n">PHASE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionPhase</span><span class="p">,</span>
                              <span class="n">ComplexType</span><span class="o">.</span><span class="n">REAL</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionReal</span><span class="p">,</span>
                              <span class="n">ComplexType</span><span class="o">.</span><span class="n">REALIMAG</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionReal_Imag</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complex_function_maps</span> <span class="o">=</span> <span class="p">{</span><span class="n">ComplexType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">,),</span>
                                      <span class="n">ComplexType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">,),</span>
                                      <span class="n">ComplexType</span><span class="o">.</span><span class="n">MAGPHASE</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">),</span>
                                      <span class="n">ComplexType</span><span class="o">.</span><span class="n">PHASE</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">,),</span>
                                      <span class="n">ComplexType</span><span class="o">.</span><span class="n">REAL</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">,),</span>
                                      <span class="n">ComplexType</span><span class="o">.</span><span class="n">REALIMAG</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complex_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">:</span> <span class="s1">&#39;Imag&#39;</span><span class="p">,</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">:</span> <span class="s1">&#39;Mag&#39;</span><span class="p">,</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">:</span> <span class="s1">&#39;Angle&#39;</span><span class="p">,</span>
                               <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">:</span> <span class="s1">&#39;Real&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">ct</span><span class="p">,</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">complex_types</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complex_types</span><span class="p">[</span><span class="n">complex_type</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionAbscissa_Log</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa_log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOrdinate_Log</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ordinate_log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuShare_Axes</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOverlay</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># TODO Remove when you implement non-overlapping plots</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect_callbacks</span><span class="p">()</span>
        <span class="c1"># Set the first plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">selectRow</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;GUIPlot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="GUIPlot.connect_callbacks"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.connect_callbacks">[docs]</a>    <span class="k">def</span> <span class="nf">connect_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connects the callback functions to events</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">itemSelectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionImaginary</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_imaginary</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionMagnitude</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_magnitude</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionMagnitude_Phase</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_magnitude_phase</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionPhase</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_phase</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionReal</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_real</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionReal_Imag</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_real_imag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOrdinate_Log</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_ordinate_log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionAbscissa_Log</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_abscissa_log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_checkbox</span><span class="p">)</span></div>

<div class="viewcode-block" id="GUIPlot.update"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the figure in the GUIPlot</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># print(&#39;Updating&#39;)</span>
        <span class="n">select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">selectionModel</span><span class="p">()</span>
        <span class="c1"># print(&#39;Has Selection {:}&#39;.format(select.hasSelection()))</span>
        <span class="n">row_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">select</span><span class="o">.</span><span class="n">selectedRows</span><span class="p">()]</span>
        <span class="c1"># print(&#39;Rows Selected {:}&#39;.format(row_indices))</span>
        <span class="c1"># Check if we want to plot them all on one plot</span>
        <span class="c1"># Get existing xaxis to keep it consistent</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xrange</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphicsLayoutWidget</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">getViewBox</span><span class="p">()</span><span class="o">.</span><span class="n">viewRange</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">xrange</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># print(xrange)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicsLayoutWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionOverlay</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="c1"># print(&#39;Single Plot&#39;)</span>
            <span class="c1"># Figure out which is checked</span>
            <span class="n">checked_complex_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span>
                                    <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">complex_types</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">plots</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">complex_fn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">complex_function_maps</span><span class="p">[</span><span class="n">checked_complex_type</span><span class="p">]):</span>
                <span class="n">plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graphicsLayoutWidget</span><span class="o">.</span><span class="n">addPlot</span><span class="p">(</span>
                    <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">complex_labels</span><span class="p">[</span><span class="n">complex_fn</span><span class="p">]})</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">plot</span><span class="o">.</span><span class="n">setXLink</span><span class="p">(</span><span class="n">plots</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plot</span><span class="o">.</span><span class="n">addLegend</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_indices</span><span class="p">):</span>
                    <span class="n">data_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                    <span class="n">original_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_original_shape</span><span class="p">)</span>
                    <span class="n">legend_entry</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:}</span><span class="s1"> </span><span class="si">{:}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">original_index</span><span class="p">,</span> <span class="n">data_entry</span><span class="o">.</span><span class="n">coordinate</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">pen</span> <span class="o">=</span> <span class="n">pyqtgraph</span><span class="o">.</span><span class="n">mkPen</span><span class="p">(</span>
                        <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="p">(</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm_mod</span><span class="p">)])</span>
                    <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_entry</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">complex_fn</span><span class="p">(</span><span class="n">data_entry</span><span class="o">.</span><span class="n">ordinate</span><span class="p">)</span> <span class="o">*</span>
                              <span class="p">(</span><span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">if</span> <span class="n">complex_fn</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span> <span class="k">else</span> <span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">legend_entry</span><span class="p">,</span> <span class="n">pen</span><span class="o">=</span><span class="n">pen</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">compare_data_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                        <span class="n">pen</span> <span class="o">=</span> <span class="n">pyqtgraph</span><span class="o">.</span><span class="n">mkPen</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">255</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span>
                                              <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm_mod</span><span class="p">)])</span>
                        <span class="n">plot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">compare_data_entry</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">complex_fn</span><span class="p">(</span><span class="n">compare_data_entry</span><span class="o">.</span><span class="n">ordinate</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                            <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="k">if</span> <span class="n">complex_fn</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span> <span class="k">else</span> <span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="n">legend_entry</span> <span class="o">+</span> <span class="s1">&#39; Comparison&#39;</span><span class="p">,</span> <span class="n">pen</span><span class="o">=</span><span class="n">pen</span><span class="p">)</span>
                <span class="n">plot</span><span class="o">.</span><span class="n">setLogMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa_log</span><span class="p">,</span>
                                <span class="kc">False</span> <span class="k">if</span> <span class="n">complex_fn</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordinate_log</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">xrange</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">plot</span><span class="o">.</span><span class="n">setXRange</span><span class="p">(</span><span class="o">*</span><span class="n">xrange</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span></div>

<div class="viewcode-block" id="GUIPlot.update_data"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.update_data">[docs]</a>    <span class="k">def</span> <span class="nf">update_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">,</span> <span class="n">new_compare_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">original_coordinate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coordinate</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">data_original_shape</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">new_coordinate</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">coordinate</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">original_coordinate</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">new_coordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="ow">or</span>
                <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">original_coordinate</span> <span class="o">!=</span> <span class="n">new_coordinate</span><span class="p">))):</span>
            <span class="c1"># Redo the table</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">new_data</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">():</span>
                <span class="n">this_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">insertRow</span><span class="p">(</span><span class="n">this_row</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">response_coordinate</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">response_coordinate</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">fn</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="s1">&#39;coordinate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">reference_coordinate</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                        <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fn</span><span class="o">.</span><span class="n">reference_coordinate</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">_imat_function_type_inverse_map</span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="n">function_type</span><span class="p">]))</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidgetItem</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">_imat_function_type_inverse_map</span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="n">function_type</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">this_row</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_original_shape</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">shape</span>

        <span class="k">if</span> <span class="n">new_compare_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Dark2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cm_mod</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_data</span> <span class="o">=</span> <span class="n">new_compare_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Paired</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cm_mod</span> <span class="o">=</span> <span class="mi">12</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="GUIPlot.selection_changed"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.selection_changed">[docs]</a>    <span class="k">def</span> <span class="nf">selection_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called when the selected functions is changed&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="GUIPlot.deselect_all_complex_types_except"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.deselect_all_complex_types_except">[docs]</a>    <span class="k">def</span> <span class="nf">deselect_all_complex_types_except</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">complex_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deselects all complex types except the specified type.</span>

<span class="sd">        Makes the checkboxes in the menu act like radiobuttons</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        complex_type : ComplexType</span>
<span class="sd">            Enumeration specifying which complex plot type is selected</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">ct</span><span class="p">,</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">complex_types</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">action</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ct</span> <span class="ow">is</span> <span class="n">complex_type</span><span class="p">:</span>
                <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">action</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">action</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="GUIPlot.set_imaginary"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.set_imaginary">[docs]</a>    <span class="k">def</span> <span class="nf">set_imaginary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the complex type to imaginary&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselect_all_complex_types_except</span><span class="p">(</span><span class="n">ComplexType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="p">)</span></div>

<div class="viewcode-block" id="GUIPlot.set_real"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.set_real">[docs]</a>    <span class="k">def</span> <span class="nf">set_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the complex type to real&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselect_all_complex_types_except</span><span class="p">(</span><span class="n">ComplexType</span><span class="o">.</span><span class="n">REAL</span><span class="p">)</span></div>

<div class="viewcode-block" id="GUIPlot.set_magnitude"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.set_magnitude">[docs]</a>    <span class="k">def</span> <span class="nf">set_magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the complex type to magnitude&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselect_all_complex_types_except</span><span class="p">(</span><span class="n">ComplexType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="p">)</span></div>

<div class="viewcode-block" id="GUIPlot.set_phase"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.set_phase">[docs]</a>    <span class="k">def</span> <span class="nf">set_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the complex type to phase&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselect_all_complex_types_except</span><span class="p">(</span><span class="n">ComplexType</span><span class="o">.</span><span class="n">PHASE</span><span class="p">)</span></div>

<div class="viewcode-block" id="GUIPlot.set_magnitude_phase"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.set_magnitude_phase">[docs]</a>    <span class="k">def</span> <span class="nf">set_magnitude_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the complex type to magnitude and phase&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselect_all_complex_types_except</span><span class="p">(</span><span class="n">ComplexType</span><span class="o">.</span><span class="n">MAGPHASE</span><span class="p">)</span></div>

<div class="viewcode-block" id="GUIPlot.set_real_imag"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.set_real_imag">[docs]</a>    <span class="k">def</span> <span class="nf">set_real_imag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the complex type to real and imaginary&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deselect_all_complex_types_except</span><span class="p">(</span><span class="n">ComplexType</span><span class="o">.</span><span class="n">REALIMAG</span><span class="p">)</span></div>

<div class="viewcode-block" id="GUIPlot.update_abscissa_log"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.update_abscissa_log">[docs]</a>    <span class="k">def</span> <span class="nf">update_abscissa_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates whether the abscissa should be plotted as log scale&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abscissa_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionAbscissa_Log</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="GUIPlot.update_ordinate_log"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.update_ordinate_log">[docs]</a>    <span class="k">def</span> <span class="nf">update_ordinate_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates whether the ordinate should be plotted as log scale&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ordinate_log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actionOrdinate_Log</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>

<div class="viewcode-block" id="GUIPlot.update_checkbox"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.GUIPlot.html#sdynpy.core.sdynpy_data.GUIPlot.update_checkbox">[docs]</a>    <span class="k">def</span> <span class="nf">update_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Disables the update button if set to auto-update&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkBox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="MPLCanvas"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.MPLCanvas.html#sdynpy.core.sdynpy_data.MPLCanvas">[docs]</a><span class="k">class</span> <span class="nc">MPLCanvas</span><span class="p">(</span><span class="n">FigureCanvas</span><span class="p">):</span>
    <span class="c1"># This is a custom widget that can be used to put plots into a GUI window</span>
<div class="viewcode-block" id="MPLCanvas.__init__"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.MPLCanvas.html#sdynpy.core.sdynpy_data.MPLCanvas.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

        <span class="n">FigureCanvas</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

        <span class="n">FigureCanvas</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
        <span class="n">FigureCanvas</span><span class="o">.</span><span class="n">updateGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MPLMultiCanvas"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.MPLMultiCanvas.html#sdynpy.core.sdynpy_data.MPLMultiCanvas">[docs]</a><span class="k">class</span> <span class="nc">MPLMultiCanvas</span><span class="p">(</span><span class="n">FigureCanvas</span><span class="p">):</span>
    <span class="c1"># This is a custom widget that can be used to put plots into a GUI window</span>
<div class="viewcode-block" id="MPLMultiCanvas.__init__"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.MPLMultiCanvas.html#sdynpy.core.sdynpy_data.MPLMultiCanvas.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ignore_subplots</span><span class="o">=</span><span class="p">[]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">subplots</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">subplots</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">subplots</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">subplots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">ignore_subplots</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">subplots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">subplots</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="p">)</span>

        <span class="n">FigureCanvas</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

        <span class="n">FigureCanvas</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
        <span class="n">FigureCanvas</span><span class="o">.</span><span class="n">updateGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CPSDPlot"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot">[docs]</a><span class="k">class</span> <span class="nc">CPSDPlot</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>

<div class="viewcode-block" id="CPSDPlot.DataType"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.DataType">[docs]</a>    <span class="k">class</span> <span class="nc">DataType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
        <span class="n">MAGNITUDE</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">COHERENCE</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">PHASE</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">REAL</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">IMAGINARY</span> <span class="o">=</span> <span class="mi">16</span></div>

<div class="viewcode-block" id="CPSDPlot.__init__"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">PowerSpectralDensityArray</span><span class="p">,</span>
                 <span class="n">compare_data</span><span class="p">:</span> <span class="n">PowerSpectralDensityArray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">validate_common_abscissa</span><span class="p">(</span><span class="n">rtol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Data must have common abscissa&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">compare_data</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;compare_data.ordinate must have the same size as data.ordinate (</span><span class="si">{:}</span><span class="s1"> != </span><span class="si">{:}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">compare_data</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">ordinate</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abscissa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compare_matrix</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span>
            <span class="n">compare_data</span><span class="o">.</span><span class="n">reshape_to_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">ordinate</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">Dark2</span> <span class="k">if</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">cm</span><span class="o">.</span><span class="n">Paired</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coh_matrix</span> <span class="o">=</span> <span class="n">sp_coherence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compare_coh_matrix</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">compare_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sp_coherence</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compare_matrix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_start</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_rectangles</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_rectangles</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectUI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_matrix_plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.initUI"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.initUI">[docs]</a>    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Main Widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span><span class="p">)</span>
        <span class="c1"># Figure Control Groupbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox</span><span class="p">)</span>
        <span class="c1"># Figure Selection Group Box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_select_groupbox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_select_groupbox_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_select_groupbox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_select_groupbox_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_select_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="c1"># Grid Layout for Selection Buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_select_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diagonal_select_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_selection_button</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_tri_select_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_tri_select_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invert_select_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">invert_select_button</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotted_select_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotted_select_button</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_tri_select_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_tri_select_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_deselect_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">diagonal_deselect_button</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_tri_deselect_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_tri_deselect_button</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_tri_deselect_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_tri_deselect_button</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_button_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="p">)</span>
        <span class="c1"># Plotting Options Groupbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="c1"># Grid layout for plot buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_selected_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_selected_button</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_mode_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="c1"># Radio Buttons for plotting method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_mode_button</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_mode_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_mode_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_mode_button</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequential_mode_button</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_mode_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequential_mode_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_mode_layout</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_layout</span><span class="p">)</span>
        <span class="c1"># Grid Layout for the function types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_type_layout</span> <span class="o">=</span> <span class="n">QGridLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_type_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_type_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_type_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_type_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_type_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_type_checkboxes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="p">]</span>
        <span class="c1"># Set them so they are tristate</span>
        <span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="p">]:</span>
            <span class="n">box</span><span class="o">.</span><span class="n">setTristate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function_type_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="p">)</span>
        <span class="c1"># Finish setting up the main window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_widget</span><span class="p">)</span>
        <span class="c1"># Set up the menu bar</span>
        <span class="c1"># self.menubar = QMenuBar(self)</span>
        <span class="c1"># self.menubar.setGeometry(QRect(0, 0, 742, 21))</span>
        <span class="c1"># self.menubar.setAccessibleName(&quot;&quot;)</span>
        <span class="c1"># self.menuFile = QMenu(self.menubar)</span>
        <span class="c1"># self.menuFigure = QMenu(self.menubar)</span>
        <span class="c1"># self.setMenuBar(self.menubar)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_dock</span> <span class="o">=</span> <span class="n">QDockWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_dock</span><span class="o">.</span><span class="n">setFeatures</span><span class="p">(</span><span class="n">QDockWidget</span><span class="o">.</span><span class="n">DockWidgetFloatable</span> <span class="o">|</span>
                                        <span class="n">QDockWidget</span><span class="o">.</span><span class="n">DockWidgetMovable</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_dock_main</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_dock_main_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">functions_dock_main</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_groupbox</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">functions_dock_main</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_groupbox_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_groupbox</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">functions_groupbox_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_dock_main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">functions_groupbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_dock</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">functions_dock_main</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addDockWidget</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DockWidgetArea</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">functions_dock</span><span class="p">)</span>

        <span class="c1"># self.actionLoad_Matrix = QAction(self)</span>
        <span class="c1"># self.actionLoad_Matrix.setObjectName(&quot;actionLoad_Matrix&quot;)</span>
        <span class="c1"># self.actionExit = QAction(self)</span>
        <span class="c1"># self.actionExit.setObjectName(&quot;actionExit&quot;)</span>
        <span class="c1"># self.actionSave_Figure = QAction(self)</span>
        <span class="c1"># self.actionSave_Figure.setObjectName(&quot;actionSave_Figure&quot;)</span>
        <span class="c1"># self.menuFile.addAction(self.actionLoad_Matrix)</span>
        <span class="c1"># self.menuFile.addSeparator()</span>
        <span class="c1"># self.menuFile.addAction(self.actionExit)</span>
        <span class="c1"># self.menuFigure.addAction(self.actionSave_Figure)</span>
        <span class="c1"># self.menubar.addAction(self.menuFile.menuAction())</span>
        <span class="c1"># self.menubar.addAction(self.menuFigure.menuAction())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">settext</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.settext"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.settext">[docs]</a>    <span class="k">def</span> <span class="nf">settext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Cross-power Spectral Density Matrix Viewer&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig_control_groupbox</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Figure Control&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_select_groupbox</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Function Select&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selection_options_groupbox</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Selection Options&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_select_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Select Diagonal&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Clear Selection&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_tri_select_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Select Upper Triangle&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invert_select_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Invert Selection&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotted_select_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Select Plotted&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_tri_select_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Select Lower Triangle&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_deselect_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Deselect Diagonal&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_tri_deselect_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Deselect Upper Triangle&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_tri_deselect_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Deselect Lower Triangle&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Matrix Select Mode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotting_options_groupbox</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Plotting Options&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_selected_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Plot Selected&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_mode_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Matrix Mode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequential_mode_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Sequential Mode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Phase&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Magnitude&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Coherence&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Imaginary&quot;</span><span class="p">)</span>
        <span class="c1"># self.menuFile.setTitle(&quot;File&quot;)</span>
        <span class="c1"># self.menuFigure.setTitle(&quot;Figure&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_groupbox</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Functions&quot;</span><span class="p">)</span></div>
        <span class="c1"># self.actionLoad_Matrix.setText(&quot;Load Matrix...&quot;)</span>
        <span class="c1"># self.actionExit.setText(&quot;Exit&quot;)</span>
        <span class="c1"># self.actionSave_Figure.setText(&quot;Save Figure...&quot;)</span>

<div class="viewcode-block" id="CPSDPlot.connectUI"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.connectUI">[docs]</a>    <span class="k">def</span> <span class="nf">connectUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.actionLoad_Matrix.triggered.connect(self.load)</span>
        <span class="c1"># self.actionExit.triggered.connect(self.quit)</span>
        <span class="c1"># Selection Method checkbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state_changed</span><span class="p">)</span>
        <span class="c1"># Plot type checkboxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">magnitude_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coherence_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imaginary_state</span><span class="p">)</span>
        <span class="c1"># Selection Buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_select_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_diagonal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diagonal_deselect_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deselect_diagonal</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_tri_select_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_upper_triangular</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_tri_deselect_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deselect_upper_triangular</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_tri_select_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_lower_triangular</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_tri_deselect_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deselect_lower_triangular</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_selection_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_selection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">invert_select_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">invert_selection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotted_select_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">select_plotted</span><span class="p">)</span>
        <span class="c1"># Plot Button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_selected_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_selected_function</span><span class="p">)</span></div>

<div class="viewcode-block" id="CPSDPlot.init_matrix_plot"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.init_matrix_plot">[docs]</a>    <span class="k">def</span> <span class="nf">init_matrix_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create the matrix</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">max_freq_lines</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="n">freq_decimate_factor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">max_freq_lines</span><span class="p">))</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">indices</span><span class="p">[</span><span class="n">freq_decimate_factor</span> <span class="o">//</span> <span class="mi">2</span><span class="p">::</span><span class="n">freq_decimate_factor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span> <span class="o">=</span> <span class="n">MPLCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">setFocusPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">ClickFocus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector_click</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_release_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector_unclick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_rectangles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_rectangles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_select_groupbox_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]))</span>
                <span class="n">data</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">/=</span> <span class="o">-</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">abscissa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">logical_selector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">.5</span><span class="p">,</span> <span class="n">data</span> <span class="o">&lt;</span> <span class="mf">.5</span><span class="p">),</span> <span class="n">indices</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">abscissa</span><span class="p">[</span><span class="n">logical_selector</span><span class="p">],</span>
                                        <span class="n">data</span><span class="p">[</span><span class="n">logical_selector</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">.5</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>
                <span class="c1"># Create the rectangle</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_rectangles</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
                    <span class="n">Rectangle</span><span class="p">((</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_rectangles</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
                    <span class="n">Rectangle</span><span class="p">((</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">axis</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)</span></div>
<span class="c1">#        # Get the current widget size and resize if necessary</span>
<span class="c1">#        self.selector.updateGeometry()</span>
<span class="c1">#        w = self.selector.width()</span>
<span class="c1">#        h = self.selector.height()</span>
<span class="c1">#        print((w,h))</span>
<span class="c1">#        self.selector.resize(shape[2]*10 if w &lt; shape[2]*10 else w,</span>
<span class="c1">#                             shape[1]*10 if h &lt; shape[1]*10 else h)</span>
<span class="c1">#        self.selector.updateGeometry()</span>

<div class="viewcode-block" id="CPSDPlot.selector_click"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.selector_click">[docs]</a>    <span class="k">def</span> <span class="nf">selector_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># print(&#39;{:} Click: button={:}, x={:}, y={:}, xdata={:}, ydata={:}&#39;.format(</span>
        <span class="c1">#         &#39;double&#39; if event.dblclick else &#39;single&#39;,</span>
        <span class="c1">#         event.button, event.x,event.y,event.xdata,event.ydata))</span>
        <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_start</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span></div>

<div class="viewcode-block" id="CPSDPlot.selector_unclick"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.selector_unclick">[docs]</a>    <span class="k">def</span> <span class="nf">selector_unclick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">modifiers</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">keyboardModifiers</span><span class="p">()</span>
        <span class="c1"># print(&#39;{:} Release: button={:}, x={:}, y={:}, xdata={:}, ydata={:}&#39;.format(</span>
        <span class="c1">#         &#39;double&#39; if event.dblclick else &#39;single&#39;,</span>
        <span class="c1">#         event.button, event.x,event.y,event.xdata,event.ydata))</span>
        <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ii</span><span class="p">,</span> <span class="n">ji</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_start</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">select_start</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>
        <span class="c1"># See if we need to switch them</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ii</span><span class="p">:</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">ii</span> <span class="o">=</span> <span class="n">ii</span><span class="p">,</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">ji</span><span class="p">:</span>
            <span class="n">j</span><span class="p">,</span> <span class="n">ji</span> <span class="o">=</span> <span class="n">ji</span><span class="p">,</span> <span class="n">j</span>
        <span class="k">if</span> <span class="n">modifiers</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ShiftModifier</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">ii</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ji</span><span class="p">:</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">modifiers</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span> <span class="ow">and</span> <span class="n">ii</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">ji</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[:]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">ii</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ji</span><span class="p">:</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extend_selection_matrix</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.select_upper_triangular"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.select_upper_triangular">[docs]</a>    <span class="k">def</span> <span class="nf">select_upper_triangular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.select_lower_triangular"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.select_lower_triangular">[docs]</a>    <span class="k">def</span> <span class="nf">select_lower_triangular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.select_diagonal"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.select_diagonal">[docs]</a>    <span class="k">def</span> <span class="nf">select_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.deselect_upper_triangular"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.deselect_upper_triangular">[docs]</a>    <span class="k">def</span> <span class="nf">deselect_upper_triangular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.deselect_lower_triangular"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.deselect_lower_triangular">[docs]</a>    <span class="k">def</span> <span class="nf">deselect_lower_triangular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.deselect_diagonal"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.deselect_diagonal">[docs]</a>    <span class="k">def</span> <span class="nf">deselect_diagonal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.clear_selection"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.clear_selection">[docs]</a>    <span class="k">def</span> <span class="nf">clear_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[:]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.invert_selection"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.invert_selection">[docs]</a>    <span class="k">def</span> <span class="nf">invert_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.select_plotted"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.select_plotted">[docs]</a>    <span class="k">def</span> <span class="nf">select_plotted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">[:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.magnitude_state"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.magnitude_state">[docs]</a>    <span class="k">def</span> <span class="nf">magnitude_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># print(&#39;Magnitude Checkbox Fired&#39;)</span>
        <span class="c1"># print(self.magnitude_checkbox.checkState())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">magnitude_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="CPSDPlot.coherence_state"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.coherence_state">[docs]</a>    <span class="k">def</span> <span class="nf">coherence_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># print(&#39;Coherence Checkbox Fired&#39;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">COHERENCE</span><span class="o">.</span><span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coherence_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">COHERENCE</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="CPSDPlot.phase_state"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.phase_state">[docs]</a>    <span class="k">def</span> <span class="nf">phase_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># print(&#39;Phase Checkbox Fired&#39;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">PHASE</span><span class="o">.</span><span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phase_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">PHASE</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="CPSDPlot.real_state"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.real_state">[docs]</a>    <span class="k">def</span> <span class="nf">real_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># print(&#39;Real Checkbox Fired&#39;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">REAL</span><span class="o">.</span><span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">real_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">REAL</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="CPSDPlot.imaginary_state"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.imaginary_state">[docs]</a>    <span class="k">def</span> <span class="nf">imaginary_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="c1"># print(&#39;Imaginary Checkbox Fired&#39;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="o">.</span><span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imaginary_checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="CPSDPlot.plot_selected_function"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.plot_selected_function">[docs]</a>    <span class="k">def</span> <span class="nf">plot_selected_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">[:]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">):</span>
            <span class="c1">#            print((key,val))</span>
            <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_rectangles</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_rectangles</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.update_selection"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.update_selection">[docs]</a>    <span class="k">def</span> <span class="nf">update_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># print(&#39;updating selection&#39;)</span>
        <span class="c1"># Update the function type check boxes</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_function_types</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">val</span><span class="p">,</span> <span class="n">checkbox</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_type_checkboxes</span><span class="p">):</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">):</span>
            <span class="c1">#            print((key,val))</span>
            <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_rectangles</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">select_rectangles</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># print(&#39;drawing&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.extend_selection_matrix"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.extend_selection_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">extend_selection_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">cols</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span></div>

<div class="viewcode-block" id="CPSDPlot.state_changed"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.state_changed">[docs]</a>    <span class="k">def</span> <span class="nf">state_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_select_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extend_selection_matrix</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_selection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selector</span><span class="o">.</span><span class="n">setFocus</span><span class="p">()</span></div>

<div class="viewcode-block" id="CPSDPlot.find_function_types"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.find_function_types">[docs]</a>    <span class="k">def</span> <span class="nf">find_function_types</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># print(self.plot_type_bits.shape)</span>
        <span class="c1"># print(self.selected_function.shape)</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selected_function</span><span class="p">]</span>
        <span class="c1"># print(mat)</span>
        <span class="n">any_functions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">mat</span> <span class="o">&amp;</span> <span class="n">bit</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">COHERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                                                   <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">PHASE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">REAL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="o">.</span><span class="n">value</span><span class="p">]]</span>
        <span class="n">all_functions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">mat</span> <span class="o">&amp;</span> <span class="n">bit</span><span class="p">)</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">COHERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                                                   <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">PHASE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">REAL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="o">.</span><span class="n">value</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">any_functions</span><span class="p">,</span> <span class="n">all_functions</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="CPSDPlot.plot"><a class="viewcode-back" href="../../../_autosummary/sdynpy.core.sdynpy_data.CPSDPlot.html#sdynpy.core.sdynpy_data.CPSDPlot.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># print(&#39;plotting&#39;)</span>
        <span class="c1"># Create the figure and put it in the dock</span>
        <span class="n">functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">]</span>
        <span class="n">coherence_functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coh_matrix</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">compare_functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_matrix</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">]</span>
            <span class="n">compare_coherence_functions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_coh_matrix</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">]</span>
            <span class="n">cm_increment</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cm_increment</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">plot_bits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_bits</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_mode_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">indices_to_skip</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                    <span class="c1"># print((row,col))</span>
                    <span class="c1"># print(self.plotted_function.shape)</span>
                    <span class="c1"># print(self.plotted_function[row,col])</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotted_function</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]:</span>
                        <span class="n">indices_to_skip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">square_array_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">functions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">square_array_size</span><span class="p">)</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">functions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">nrows</span><span class="p">))</span>
            <span class="n">indices_to_skip</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">functions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">*</span> <span class="n">ncols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="c1"># Create the canvas</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Delete the canvas if it exists</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">functions_groupbox_layout</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_canvas</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_canvas</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c1"># print(&#39;No Widget to Remove&#39;)</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_canvas</span> <span class="o">=</span> <span class="n">MPLMultiCanvas</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">subplots</span><span class="o">=</span><span class="p">[</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">],</span> <span class="n">ignore_subplots</span><span class="o">=</span><span class="n">indices_to_skip</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functions_groupbox_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_canvas</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_canvas</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">function</span> <span class="o">=</span> <span class="n">functions</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span>
            <span class="n">coh_function</span> <span class="o">=</span> <span class="n">coherence_functions</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">compare_function</span> <span class="o">=</span> <span class="n">compare_functions</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span>
                <span class="n">compare_coh_function</span> <span class="o">=</span> <span class="n">compare_coherence_functions</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">compare_function</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                <span class="n">compare_coh_function</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">bits</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">COHERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">PHASE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">REAL</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">plot_bits</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">val</span><span class="p">)]</span>
            <span class="n">plots</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">bits</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">MAGNITUDE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">function</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">compare_function</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">bit</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">COHERENCE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">coh_function</span><span class="p">,</span> <span class="n">compare_coh_function</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">bit</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">PHASE</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">function</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">compare_function</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">bit</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">REAL</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">function</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">compare_function</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">bit</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataType</span><span class="o">.</span><span class="n">IMAGINARY</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                    <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">function</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">compare_function</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">))</span>
            <span class="c1"># Add a y axis for each plot</span>
            <span class="n">this_ax</span> <span class="o">=</span> <span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plots</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">compare_fn</span><span class="p">,</span> <span class="n">color_index</span><span class="p">,</span> <span class="n">scale</span><span class="p">),</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">plots</span><span class="p">,</span> <span class="n">this_ax</span><span class="p">):</span>
                <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="p">(</span><span class="n">color_index</span> <span class="o">*</span> <span class="n">cm_increment</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">compare_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="p">(</span><span class="n">color_index</span> <span class="o">*</span> <span class="n">cm_increment</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abscissa</span><span class="p">,</span> <span class="n">compare_fn</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">compare_color</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span></div></div>
<span class="c1">#        self.plot_canvas.fig.tight_layout()</span>



<span class="n">frf_from_time_data</span> <span class="o">=</span> <span class="n">TransferFunctionArray</span><span class="o">.</span><span class="n">from_time_data</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 National Technology &amp; Engineering Solutions of Sandia,     LLC (NTESS). Under the terms of Contract DE-NA0003525 with NTESS,     the U.S. Government retains certain rights in this software.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>